<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bilgi Hazinesi - Eğitimin Keşif Dünyası</title>
    
    <link rel="stylesheet" href="stiller/stil.css">
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
</head>
<body>

    <div id="lichess-menu-placeholder"></div>
    
    <div class="page-wrapper">
        <header class="header">
            <h1>Bilgi Hazinesi</h1>
            <p>Öğrenmenin Keşif Dolu Dünyasına Hoş Geldiniz!</p>
        </header>
        
        <nav class="desktop-nav">
            <ul id="desktop-nav-ul">
                </ul>
        </nav>

        <main class="container">
            <p class="intro">
                <strong>Bilgi Hazinesi ekibi olarak,</strong> sizler için hazırladığımız birbirinden keyifli ders içeriklerine aşağıdaki kartlara tıklayarak ulaşabilirsiniz. İyi eğlenceler!
            </p>

            <div class="card-container" id="card-container">
                </div>
        </main>

        <footer class="footer">
            <p>&copy; 2025 Bilgi Hazinesi Ekibi - Tüm Hakları Saklıdır.</p>
        </footer>
    </div>

    <script src="bilesenler/lichess-menu.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            fetch('sayfalar.json')
                .then(response => response.json())
                .then(data => {
                    buildHomepageContent(data);
                })
                .catch(error => {
                    console.error('Anasayfa içeriği yüklenirken hata oluştu:', error);
                });
        });

        function buildHomepageContent(data) {
            const desktopNavUl = document.getElementById('desktop-nav-ul');
            const cardContainer = document.getElementById('card-container');
            if(!desktopNavUl || !cardContainer) return;

            desktopNavUl.innerHTML = '<li><a href="index.html">Anasayfa</a></li>';

            data.forEach(kategori => {
                // Masaüstü Menüyü Oluştur
                let desktopNavHtml = `
                    <li data-nav-id="${kategori.id}">
                        <a href="#">${kategori.isim}</a>
                        <div class="nav-dropdown-content">
                `;
                kategori.sayfalar.forEach(sayfa => {
                    desktopNavHtml += `<a href="${sayfa.url}">${sayfa.isim}</a>`;
                });
                desktopNavHtml += '</div></li>';
                desktopNavUl.innerHTML += desktopNavHtml;

                // Ders Kartlarını Oluştur
                let cardHtml = `
                    <div class="card ${kategori.id}" data-target-id="${kategori.id}">
                        <div class="icon"><i class="bi ${kategori.ikon}"></i></div>
                        <h2>${kategori.isim}</h2>
                        <p>${kategori.aciklama}</p>
                        <ul class="card-sub-links">
                `;
                kategori.sayfalar.forEach(sayfa => {
                    cardHtml += `<li><a href="${sayfa.url}">${sayfa.isim}</a></li>`;
                });
                cardHtml += '</ul></div>';
                cardContainer.innerHTML += cardHtml;
            });
            
            // Kartların tıklama olaylarını kur
            setupCardClickEvents();
        }

        function setupCardClickEvents() {
            const cards = document.querySelectorAll('.card');
            cards.forEach(card => {
                card.addEventListener('click', function(event) {
                    if (event.target.tagName === 'A') {
                        return;
                    }
                    const cardSubLinks = this.querySelector('.card-sub-links');
                    if (!cardSubLinks) return;
                    
                    const isAlreadyOpen = cardSubLinks.style.maxHeight;

                    document.querySelectorAll('.card-sub-links').forEach(menu => {
                        menu.style.maxHeight = null;
                        menu.classList.remove('show');
                    });
                    
                    if (!isAlreadyOpen) {
                        cardSubLinks.classList.add('show');
                        cardSubLinks.style.maxHeight = cardSubLinks.scrollHeight + "px";
                    }
                });
            });
        }
    </script>
</body>
</html>
