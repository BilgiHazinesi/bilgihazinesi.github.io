<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ã–ÄŸrenci Paneli (V66)</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
/* --- PREMIUM Ã–ÄžRENCÄ° TEMASI --- */
:root { --bg: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); --glass: rgba(255,255,255,0.6); --border: 1px solid rgba(255,255,255,0.8); --primary: #ff6b6b; --text: #2d3436; }
body { margin:0; padding:20px; background:var(--bg); color:var(--text); min-height:100vh; font-family:'Segoe UI',sans-serif; }
.container { max-width:500px; margin:0 auto; display:none; }
.glass-panel { background:var(--glass); border-radius:24px; padding:20px; margin-bottom:20px; border:var(--border); backdrop-filter:blur(10px); box-shadow:0 10px 30px rgba(0,0,0,0.1); }
#loginOverlay { position:fixed; inset:0; background:var(--bg); z-index:999; display:flex; justify-content:center; align-items:center; }
.login-box { background:var(--glass); padding:40px; border-radius:30px; text-align:center; width:90%; border:var(--border); }
input { width:100%; padding:15px; border-radius:12px; border:var(--border); background:rgba(255,255,255,0.5); text-align:center; margin-bottom:15px; letter-spacing:3px; }
.btn { width:100%; padding:15px; border-radius:12px; border:none; background:var(--primary); color:white; font-weight:bold; cursor:pointer; }
/* UZAY */ .journey-container { position:relative; height:320px; background:radial-gradient(ellipse at bottom,#2d3436,#000); border-radius:20px; overflow:hidden; margin-top:20px; border:2px solid rgba(255,255,255,0.2); }
.stars-bg { position:absolute; inset:0; background:url('https://s3-us-west-2.amazonaws.com/s.cdpn.io/1231630/stars.png'); opacity:0.6; }
.station-point { position:absolute; width:45px; height:45px; border-radius:50%; background:rgba(255,255,255,0.1); border:2px solid rgba(255,255,255,0.3); display:flex; align-items:center; justify-content:center; font-size:1.3rem; transform:translate(-50%,-50%); z-index:5; backdrop-filter:blur(5px); }
.station-point.active { background:var(--primary); border-color:white; box-shadow:0 0 15px var(--primary); }
.astronaut-marker { position:absolute; font-size:3rem; transform:translate(-50%,-70%); filter:drop-shadow(0 0 10px gold); z-index:10; transition:all 1s ease-in-out; }
.book-card { display:flex; justify-content:space-between; align-items:center; padding:15px; border-bottom:1px solid rgba(0,0,0,0.05); background:rgba(255,255,255,0.1); border-radius:12px; margin-bottom:8px; }
.overlay { position:fixed; inset:0; background:rgba(0,0,0,0.8); z-index:2000; display:none; justify-content:center; align-items:center; padding:20px; }
.modal-card { background:#fff; width:100%; max-width:400px; border-radius:24px; padding:25px; text-align:center; }
</style>
</head>
<body>
<div id="loginOverlay"><div class="login-box"><h1>HoÅŸgeldin!</h1><input type="password" id="pass" placeholder="Ã–ÄŸrenci Kodu"><button class="btn" onclick="login()">GÄ°RÄ°Åž YAP</button></div></div>
<div id="app" class="container">
    <div class="glass-panel" style="text-align:center;">
        <div style="font-size:4rem;">ðŸŒ±</div><h2 id="sName">Ã–ÄŸrenci AdÄ±</h2><div id="rankTitle" style="font-weight:bold; color:var(--primary);">BAÅžLANGIÃ‡</div>
        <div id="medals" style="margin:10px 0; font-size:1.4rem;"></div>
        <div class="journey-container" id="studentJourneyMap"><div class="stars-bg"></div><svg id="sJourneySvg" style="position:absolute; width:100%; height:100%; pointer-events:none;"></svg></div>
    </div>
    <div class="glass-panel"><h3>ðŸ“š KitaplÄ±ÄŸÄ±m</h3><div id="bookList"></div></div>
</div>
<script>
const API = "https://script.google.com/macros/s/AKfycbwIXHbQmeT1cBEVcbYhj4cDhosnmN1ICMVI3Wq-wbzSOeR2KSrdrUhBZzwEw2ch8rEl/exec";
let data={};
const ALL_RANKS = [{c:0,t:"BaÅŸlangÄ±Ã§",e:"ðŸŒ±"},{c:5,t:"Ã‡Ä±rak",e:"ðŸ¥‰"},{c:10,t:"Kurdu",e:"ðŸ“–"},{c:15,t:"KaÅŸif",e:"ðŸš€"},{c:20,t:"AvcÄ±",e:"ðŸ¹"},{c:25,t:"MuhafÄ±z",e:"ðŸ‘‘"},{c:30,t:"Usta",e:"ðŸŽ©"},{c:35,t:"Bilge",e:"ðŸŒ"},{c:40,t:"EFSANE",e:"ðŸ’Ž"}];

function login(){ let p=document.getElementById('pass').value; if(!p)return; fetch(API+"?action=login_student&password="+p).then(r=>r.json()).then(d=>{if(d.error)alert(d.error);else{data=d;init();}}); }
function init(){
    document.getElementById('loginOverlay').style.display='none'; document.querySelector('.container').style.display='block';
    let sName=data.studentName; let myRecs=data.records.filter(r=>r.student===sName&&r.status==="Ä°ade Etti");
    document.getElementById('sName').innerText=sName;
    let rank=ALL_RANKS[0]; for(let i=0;i<ALL_RANKS.length;i++)if(myRecs.length>=ALL_RANKS[i].c)rank=ALL_RANKS[i];
    document.getElementById('rankTitle').innerText=rank.t.toUpperCase();
    let g=Math.floor(myRecs.length/data.settings.gold); let si=Math.floor(myRecs.length/data.settings.silver);
    document.getElementById('medals').innerText="ðŸ¥‡".repeat(g)+"ðŸ¥ˆ".repeat(si);
    renderJourney(myRecs.length);
    let div=document.getElementById('bookList'); div.innerHTML="";
    myRecs.forEach(r=>{div.innerHTML+=`<div class="book-card"><div><b>${r.book}</b><br><small>${r.returnDate}</small></div><button class="btn" style="width:auto; padding:5px 10px;">${r.comment?"DÃ¼zenle":"Yorumla"}</button></div>`;});
}
function renderJourney(c){
    let cont=document.getElementById('studentJourneyMap'); let svg=document.getElementById('sJourneySvg');
    let w=cont.offsetWidth, h=320; let d=`M ${w*0.1} ${h*0.8} C ${w*0.4} ${h*0.8}, ${w*0.4} ${h*0.2}, ${w*0.9} ${h*0.2}`;
    let path=document.createElementNS("http://www.w3.org/2000/svg","path"); path.setAttribute("d",d); path.setAttribute("fill","none"); path.setAttribute("stroke","rgba(255,255,255,0.3)"); path.setAttribute("stroke-width","4"); path.setAttribute("stroke-dasharray","8,8"); svg.appendChild(path);
    ALL_RANKS.forEach((r,i)=>{
        let p=i/(ALL_RANKS.length-1); let t=p;
        let x=w*(0.1*Math.pow(1-t,3)+3*0.4*Math.pow(1-t,2)*t+3*0.4*(1-t)*Math.pow(t,2)+0.9*Math.pow(t,3));
        let y=h*(0.8*Math.pow(1-t,3)+3*0.8*Math.pow(1-t,2)*t+3*0.2*(1-t)*Math.pow(t,2)+0.2*Math.pow(t,3));
        let st=document.createElement('div'); st.className=`station-point ${c>=r.c?'active':''}`; st.style.left=x+"px"; st.style.top=y+"px"; st.innerHTML=`${r.e}`;
        if(c>=r.c&&(i===ALL_RANKS.length-1||c<ALL_RANKS[i+1].c)){let a=document.createElement('div');a.className="astronaut-marker";a.innerText="ðŸš€";a.style.left=x+"px";a.style.top=(y-30)+"px";cont.appendChild(a);}
        cont.appendChild(st);
    });
}
</script>
</body>
</html>
