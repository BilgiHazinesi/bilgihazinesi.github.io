<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AkÄ±llÄ± Tahta Sunum ModÃ¼lÃ¼</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Chalkboard+SE:wght@400;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap');

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #212121; /* Tahta siyahÄ± */
            color: white;
            margin: 0;
            padding: 10px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        h1 {
            text-align: center;
            color: #ffca28;
            font-family: 'Chalkboard SE', sans-serif;
            margin: 5px 0 15px 0;
            font-size: 1.8rem;
            letter-spacing: 2px;
        }

        /* 3'lÃ¼ Panel YapÄ±sÄ± */
        .stage-container {
            display: flex;
            width: 100%;
            height: 100%;
            gap: 15px;
            padding: 0 10px 10px 10px;
            box-sizing: border-box;
        }

        .panel {
            flex: 1;
            background: #333;
            border-radius: 20px;
            border: 2px solid #555;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            position: relative;
            box-shadow: 0 10px 20px rgba(0,0,0,0.5);
        }

        /* BaÅŸlÄ±klar */
        .panel-header {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 15px;
            padding: 5px 15px;
            border-radius: 50px;
            color: #212121;
            text-transform: uppercase;
        }
        .p1-head { background: #ffab91; }
        .p2-head { background: #81d4fa; }
        .p3-head { background: #a5d6a7; }

        /* Ã–ÄŸretmen Kontrolleri (Setup) */
        .setup-area {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
            margin-bottom: 20px;
            background: rgba(0,0,0,0.2);
            padding: 10px;
            border-radius: 10px;
            width: 100%;
        }

        .num-input {
            font-size: 1.5rem;
            padding: 8px;
            width: 100px;
            text-align: center;
            border-radius: 8px;
            border: none;
            background: #424242;
            color: #ffca28;
            font-weight: bold;
        }

        .mode-btns { display: flex; gap: 5px; flex-wrap: wrap; justify-content: center; }
        
        .setup-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            font-weight: bold;
            font-size: 1rem;
            opacity: 0.6;
            transition: 0.2s;
        }
        .setup-btn.active { opacity: 1; transform: scale(1.1); box-shadow: 0 0 10px rgba(255,255,255,0.3); }
        
        .btn-5 { background: #ef6c00; }
        .btn-25 { background: #2e7d32; }
        .btn-50 { background: #1565c0; }
        .btn-125 { background: #6a1b9a; }

        /* Sunum Butonu (BÃ¼yÃ¼k Oynat TuÅŸu) */
        .play-btn {
            width: 80%;
            padding: 12px;
            margin-top: auto; /* En alta it */
            margin-bottom: 10px;
            font-size: 1.2rem;
            font-weight: bold;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            background: #ffca28;
            color: #333;
            box-shadow: 0 5px 0 #c79100;
            transition: transform 0.1s;
        }
        .play-btn:active { transform: translateY(4px); box-shadow: none; }
        .play-btn:disabled { background: #616161; box-shadow: none; color: #9e9e9e; cursor: not-allowed; }

        /* GÃ–RSEL ALAN (GRID) */
        .visual-stage {
            flex-grow: 1;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        /* Soru Metni */
        .question-text {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 20px;
            font-family: 'Chalkboard SE', sans-serif;
            color: white;
        }

        /* Grid Sistemi */
        .calc-row {
            display: flex;
            gap: 5px;
            align-items: flex-end;
            visibility: hidden; /* BaÅŸta gizli */
        }

        .digit-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            width: 50px;
        }

        .box {
            width: 50px;
            height: 50px;
            border: 2px solid #90a4ae;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            color: white;
            position: relative;
            background: #263238;
            transition: all 0.5s;
        }

        /* SÄ±fÄ±rlar sonradan gelir */
        .zero-box {
            color: #ffb74d; /* Turuncu */
            opacity: 0;
            transform: translateX(-20px);
        }
        .zero-show { opacity: 1; transform: translateX(0); }

        /* SonuÃ§ Kutusu */
        .res-box {
            width: 50px;
            height: 50px;
            margin-top: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            color: #69f0ae; /* Parlak yeÅŸil */
            border-bottom: 3px solid #69f0ae;
            opacity: 0;
        }
        .res-show { opacity: 1; transform: translateY(0); }

        /* Elde SayÄ±sÄ± (KÄ±rmÄ±zÄ± kÃ¼Ã§Ã¼k) */
        .carry {
            position: absolute;
            top: -25px; /* Kutunun Ã¼stÃ¼ */
            left: -5px;
            font-size: 1.2rem;
            color: #ff5252;
            font-weight: bold;
            opacity: 0;
            transform: translateY(10px);
            transition: all 0.5s;
        }
        .carry-show { opacity: 1; transform: translateY(0); }

        /* Vurgulama */
        .active-calc {
            border-color: #ffca28;
            box-shadow: 0 0 15px rgba(255, 202, 40, 0.4);
            z-index: 10;
        }

        .divider-sign {
            font-size: 2rem;
            margin-right: 10px;
            color: #90a4ae;
            align-self: center;
            padding-bottom: 60px; /* Hizalama ayarÄ± */
        }

        .reset-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            font-size: 1.2rem;
            color: #757575;
        }
        .reset-icon:hover { color: white; }

    </style>
</head>
<body>

    <h1>ðŸŽ¬ Matematik SinemasÄ±: Zihinden Ä°ÅŸlemler</h1>

    <div class="stage-container">
        
        <div class="panel">
            <div class="reset-icon" onclick="resetPanel(1)">â†º</div>
            <div class="panel-header p1-head">SORU 1</div>
            
            <div class="setup-area" id="setup-1">
                <input type="number" id="inp-1" class="num-input" value="12">
                <div class="mode-btns">
                    <button class="setup-btn btn-5" onclick="setMode(1, 5, this)">x5</button>
                    <button class="setup-btn btn-25" onclick="setMode(1, 25, this)">x25</button>
                    <button class="setup-btn btn-50" onclick="setMode(1, 50, this)">x50</button>
                    <button class="setup-btn btn-125" onclick="setMode(1, 125, this)">x125</button>
                </div>
            </div>

            <div class="visual-stage" id="stage-1">
                <div class="question-text" id="qtext-1">SayÄ± SeÃ§in</div>
                <div class="calc-row" id="grid-1"></div>
            </div>

            <button class="play-btn" id="btn-1" onclick="nextStep(1)">BAÅžLAT</button>
        </div>

        <div class="panel">
            <div class="reset-icon" onclick="resetPanel(2)">â†º</div>
            <div class="panel-header p2-head">SORU 2</div>
            
            <div class="setup-area" id="setup-2">
                <input type="number" id="inp-2" class="num-input" value="16">
                <div class="mode-btns">
                    <button class="setup-btn btn-5" onclick="setMode(2, 5, this)">x5</button>
                    <button class="setup-btn btn-25" onclick="setMode(2, 25, this)">x25</button>
                    <button class="setup-btn btn-50" onclick="setMode(2, 50, this)">x50</button>
                    <button class="setup-btn btn-125" onclick="setMode(2, 125, this)">x125</button>
                </div>
            </div>

            <div class="visual-stage" id="stage-2">
                <div class="question-text" id="qtext-2">SayÄ± SeÃ§in</div>
                <div class="calc-row" id="grid-2"></div>
            </div>

            <button class="play-btn" id="btn-2" onclick="nextStep(2)">BAÅžLAT</button>
        </div>

        <div class="panel">
            <div class="reset-icon" onclick="resetPanel(3)">â†º</div>
            <div class="panel-header p3-head">SORU 3</div>
            
            <div class="setup-area" id="setup-3">
                <input type="number" id="inp-3" class="num-input" value="24">
                <div class="mode-btns">
                    <button class="setup-btn btn-5" onclick="setMode(3, 5, this)">x5</button>
                    <button class="setup-btn btn-25" onclick="setMode(3, 25, this)">x25</button>
                    <button class="setup-btn btn-50" onclick="setMode(3, 50, this)">x50</button>
                    <button class="setup-btn btn-125" onclick="setMode(3, 125, this)">x125</button>
                </div>
            </div>

            <div class="visual-stage" id="stage-3">
                <div class="question-text" id="qtext-3">SayÄ± SeÃ§in</div>
                <div class="calc-row" id="grid-3"></div>
            </div>

            <button class="play-btn" id="btn-3" onclick="nextStep(3)">BAÅžLAT</button>
        </div>

    </div>

    <script>
        // Veri YapÄ±sÄ±
        const states = {
            1: { step: 0, factor: 0, div: 0, zeros: "", num: 0 },
            2: { step: 0, factor: 0, div: 0, zeros: "", num: 0 },
            3: { step: 0, factor: 0, div: 0, zeros: "", num: 0 }
        };

        const rules = {
            5: { div: 2, zeros: "0" },
            25: { div: 4, zeros: "00" },
            50: { div: 2, zeros: "00" },
            125: { div: 8, zeros: "000" }
        };

        // 1. Kurulum (Ã–ÄŸretmen SeÃ§imi)
        function setMode(pid, factor, btn) {
            // Buton gÃ¶rselliÄŸi
            const allBtns = document.querySelectorAll(`#setup-${pid} .setup-btn`);
            allBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            const inputVal = document.getElementById(`inp-${pid}`).value;
            states[pid].factor = factor;
            states[pid].num = inputVal;
            states[pid].step = 1; // HazÄ±r durumuna geÃ§
            
            // Soruyu GÃ¶ster (Ä°pucu yok, sadece iÅŸlem)
            document.getElementById(`qtext-${pid}`).innerText = `${inputVal} x ${factor} = ?`;
            document.getElementById(`grid-${pid}`).innerHTML = ''; // Temizle
            
            // Buton metnini gÃ¼ncelle
            document.getElementById(`btn-${pid}`).innerText = "1. SIFIRLARI GÃ–STER";
            document.getElementById(`btn-${pid}`).disabled = false;
        }

        // 2. AdÄ±m KontrolcÃ¼sÃ¼ (Tek Butonla YÃ¶netim)
        async function nextStep(pid) {
            const state = states[pid];
            const rule = rules[state.factor];
            const btn = document.getElementById(`btn-${pid}`);

            if (state.step === 1) {
                // ADIM: SIFIRLARI EKLE (Animasyonlu)
                // Grid'i hazÄ±rla
                prepareGrid(pid, state.num, rule.zeros, rule.div);
                
                // Soru metnini kÃ¼Ã§Ã¼lt veya kaldÄ±r
                document.getElementById(`qtext-${pid}`).style.display = 'none';
                document.getElementById(`grid-${pid}`).style.visibility = 'visible';
                
                // SÄ±fÄ±rlarÄ± animasyonla gÃ¶ster
                const zeroBoxes = document.querySelectorAll(`#grid-${pid} .zero-box`);
                for(let box of zeroBoxes) {
                    await wait(300);
                    box.classList.add('zero-show');
                }

                btn.innerText = "2. BÃ–LME Ä°ÅžLEMÄ°NÄ° OYNAT";
                state.step = 2;

            } else if (state.step === 2) {
                // ADIM: BÃ–LME ANÄ°MASYONU
                btn.disabled = true; // Ä°ÅŸlem bitene kadar kilitle
                await autoPlayDivision(pid, state.num + rule.zeros, rule.div);
                
                btn.innerText = "TEMÄ°ZLE / YENÄ° SORU";
                btn.disabled = false;
                state.step = 3;

            } else if (state.step === 3) {
                // SIFIRLA
                resetPanel(pid);
            }
        }

        // Grid HazÄ±rlama
        function prepareGrid(pid, numStr, zeros, divisor) {
            const grid = document.getElementById(`grid-${pid}`);
            grid.innerHTML = '';

            // BÃ¶len Ä°ÅŸareti
            const divSign = document.createElement('div');
            divSign.className = 'divider-sign';
            divSign.innerHTML = `Ã· ${divisor}`;
            grid.appendChild(divSign);

            const fullStr = numStr + zeros;
            
            // Rakam KutularÄ±
            for(let i=0; i < fullStr.length; i++) {
                const isZero = i >= numStr.length;
                const digit = fullStr[i];

                const group = document.createElement('div');
                group.className = 'digit-group';
                group.id = `p${pid}-g-${i}`;

                // Elde
                const carry = document.createElement('div');
                carry.className = 'carry';
                carry.id = `p${pid}-c-${i}`;
                group.appendChild(carry);

                // Kutu
                const box = document.createElement('div');
                box.className = `box ${isZero ? 'zero-box' : ''}`;
                box.innerText = digit;
                box.id = `p${pid}-b-${i}`;
                group.appendChild(box);

                // SonuÃ§ (BaÅŸta gizli)
                const res = document.createElement('div');
                res.className = 'res-box';
                res.id = `p${pid}-r-${i}`;
                group.appendChild(res);

                grid.appendChild(group);
            }
        }

        // Otomatik BÃ¶lme Animasyonu (TaÅŸÄ±ma MantÄ±ÄŸÄ± ile)
        async function autoPlayDivision(pid, fullNumberStr, divisor) {
            const digits = fullNumberStr.split('').map(Number);
            let remainder = 0;

            for(let i=0; i < digits.length; i++) {
                const box = document.getElementById(`p${pid}-b-${i}`);
                const resBox = document.getElementById(`p${pid}-r-${i}`);
                
                // 1. Kutuyu Vurgula
                box.classList.add('active-calc');
                await wait(800);

                // 2. Mevcut DeÄŸeri Hesapla (Elde + Rakam)
                let currentVal = parseInt(remainder.toString() + digits[i].toString());
                
                // 3. BÃ¶lme
                let quotient = Math.floor(currentVal / divisor);
                let newRemainder = currentVal % divisor;

                // 4. Sonucu Yaz (Animasyonla)
                resBox.innerText = quotient;
                resBox.classList.add('res-show');
                
                // 5. Elde Varsa Sonraki Kutuya GÃ¶nder
                if(i < digits.length - 1) {
                    if (newRemainder > 0) {
                        const nextCarry = document.getElementById(`p${pid}-c-${i+1}`);
                        
                        // UÃ§an sayÄ± efekti eklenebilir ama basitlik iÃ§in direkt belirsin
                        await wait(500);
                        nextCarry.innerText = newRemainder;
                        nextCarry.classList.add('carry-show');
                        
                        // Sonraki kutunun Ã¼zerine gÃ¶rsel etki
                        const nextBox = document.getElementById(`p${pid}-b-${i+1}`);
                        nextBox.style.borderColor = "#ff5252"; // KÄ±rmÄ±zÄ± uyarÄ±sÄ±
                        setTimeout(() => nextBox.style.borderColor = "#90a4ae", 800);
                    }
                }

                // Vurguyu KaldÄ±r
                await wait(500);
                box.classList.remove('active-calc');
                
                remainder = newRemainder;
            }
        }

        function resetPanel(pid) {
            states[pid].step = 0;
            document.getElementById(`qtext-${pid}`).style.display = 'block';
            document.getElementById(`qtext-${pid}`).innerText = 'SayÄ± SeÃ§in';
            document.getElementById(`grid-${pid}`).innerHTML = '';
            document.getElementById(`grid-${pid}`).style.visibility = 'hidden';
            
            // Ayar butonlarÄ±nÄ± sÄ±fÄ±rla
            const allBtns = document.querySelectorAll(`#setup-${pid} .setup-btn`);
            allBtns.forEach(b => b.classList.remove('active'));
            
            // Ana butonu sÄ±fÄ±rla
            const btn = document.getElementById(`btn-${pid}`);
            btn.innerText = "BAÅžLAT";
            btn.disabled = false; // "false" olmalÄ± ki yeniden basÄ±labilsin
        }

        function wait(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>
