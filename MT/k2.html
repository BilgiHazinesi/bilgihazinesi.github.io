<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sınıf İçi Sunum Paneli (Sağda Bölme)</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap');

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: #f0f2f5;
            color: #2c3e50;
            margin: 0;
            padding: 15px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        h1 {
            text-align: center;
            color: #37474f;
            margin: 0 0 10px 0;
            font-size: 1.6rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        /* Ana Taşıyıcı */
        .stage-container {
            display: flex;
            width: 100%;
            height: 100%;
            gap: 15px;
            padding-bottom: 5px;
            box-sizing: border-box;
        }

        /* Panel Tasarımı */
        .panel {
            flex: 1;
            background: white;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border: 1px solid #e0e0e0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 10px;
            position: relative;
            transition: all 0.3s;
        }

        /* Başlık Şeritleri */
        .panel-header {
            width: 100%;
            text-align: center;
            padding: 8px 0;
            font-size: 1.3rem;
            font-weight: bold;
            color: white;
            border-radius: 12px 12px 0 0;
            position: absolute;
            top: 0;
            left: 0;
        }
        .p1-head { background: linear-gradient(135deg, #ff8a65, #ffab91); } /* Turuncu */
        .p2-head { background: linear-gradient(135deg, #4db6ac, #80cbc4); } /* Turkuaz */
        .p3-head { background: linear-gradient(135deg, #7986cb, #9fa8da); } /* İndigo */

        .panel-content {
            margin-top: 45px;
            width: 100%;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* Ayar Bölümü */
        .setup-area {
            background: #fafafa;
            padding: 8px;
            border-radius: 8px;
            width: 95%;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            border: 1px dashed #cfd8dc;
            margin-bottom: 10px;
        }

        .num-input {
            font-size: 1.3rem;
            padding: 5px;
            width: 80px;
            text-align: center;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            color: #455a64;
            font-weight: bold;
        }

        .mode-btns { display: flex; gap: 4px; justify-content: center; width: 100%; }
        
        .setup-btn {
            padding: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
            font-weight: bold;
            font-size: 0.85rem;
            opacity: 0.7;
            flex: 1;
        }
        .setup-btn:hover { opacity: 1; }
        .setup-btn.active { opacity: 1; transform: scale(0.95); box-shadow: inset 0 2px 4px rgba(0,0,0,0.2); }
        
        .btn-5 { background: #ffa726; }
        .btn-25 { background: #66bb6a; }
        .btn-50 { background: #42a5f5; }
        .btn-125 { background: #ab47bc; }

        /* Görsel Sahne */
        .visual-stage {
            flex-grow: 1;
            width: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .question-text {
            font-size: 2.5rem;
            font-weight: bold;
            color: #546e7a;
        }

        /* Grid Sistemi */
        .calc-row {
            display: flex;
            gap: 4px;
            align-items: flex-end;
            visibility: hidden;
            padding-right: 10px; /* Sağdaki bölen için pay */
        }

        .digit-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            width: 45px;
        }

        .box {
            width: 45px;
            height: 45px;
            background: white;
            border: 2px solid #b0bec5;
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.8rem;
            font-weight: bold;
            color: #37474f;
            z-index: 1;
        }

        .zero-box {
            border-color: #ffcc80;
            color: #e65100;
            background: #fff3e0;
            opacity: 0;
            transform: translateX(-20px);
            transition: all 0.5s;
        }
        .zero-show { opacity: 1; transform: translateX(0); }

        .res-box {
            width: 45px;
            height: 45px;
            margin-top: 5px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: bold;
            color: #4caf50;
            opacity: 0;
            transform: translateY(-10px);
            transition: all 0.4s;
            border-top: 2px solid #eee; 
        }
        .res-show { opacity: 1; transform: translateY(0); border-top-color: #4caf50; }

        .carry {
            position: absolute;
            top: -22px;
            left: -8px;
            font-size: 1rem;
            color: #d32f2f;
            font-weight: bold;
            opacity: 0;
            z-index: 2;
            transition: all 0.4s;
            background: rgba(255,255,255,0.9);
            padding: 2px 5px;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .carry-show { opacity: 1; transform: translateY(0); }

        /* Bölen İşareti (SAĞDA) */
        .divider-sign {
            font-size: 2rem;
            margin-left: 10px; /* Soldan boşluk */
            color: #78909c;
            padding-bottom: 55px; /* Kutularla hizalamak için yukarı ittik */
            font-weight: bold;
            display: flex;
            align-items: center;
        }

        .active-calc {
            border-color: #29b6f6;
            background: #e1f5fe;
            box-shadow: 0 0 10px rgba(41, 182, 246, 0.4);
            transform: scale(1.1);
        }

        /* Kontrol Butonları */
        .control-bar {
            width: 100%;
            display: flex;
            gap: 8px;
            margin-top: auto;
        }

        .main-btn {
            flex: 2;
            padding: 12px;
            font-size: 1.1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: white;
            font-weight: bold;
            background: #546e7a;
            box-shadow: 0 4px 0 #37474f;
            transition: transform 0.1s;
        }
        .main-btn:active { transform: translateY(3px); box-shadow: none; }
        .main-btn:disabled { background: #cfd8dc; box-shadow: none; color: #90a4ae; cursor: default; }

        .instant-btn {
            flex: 1;
            padding: 12px;
            font-size: 1.1rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            color: white;
            font-weight: bold;
            background: #ff7043;
            box-shadow: 0 4px 0 #d84315;
        }
        .instant-btn:active { transform: translateY(3px); box-shadow: none; }
        .instant-btn:disabled { background: #ffccbc; box-shadow: none; color: white; cursor: default; }

        .reset-icon {
            position: absolute;
            top: 8px;
            right: 8px;
            cursor: pointer;
            font-size: 1.2rem;
            color: white;
            opacity: 0.8;
            z-index: 10;
        }
        .reset-icon:hover { opacity: 1; transform: rotate(90deg); transition: 0.3s; }

    </style>
</head>
<body>

    <h1>✨ Akıllı Tahta Matematik Paneli</h1>

    <div class="stage-container">
        <div class="panel">
            <div class="panel-header p1-head">
                SORU 1
                <div class="reset-icon" onclick="resetPanel(1)">↺</div>
            </div>
            <div class="panel-content">
                <div class="setup-area" id="setup-1">
                    <input type="number" id="inp-1" class="num-input" value="12">
                    <div class="mode-btns">
                        <button class="setup-btn btn-5" onclick="setMode(1, 5, this)">x5</button>
                        <button class="setup-btn btn-25" onclick="setMode(1, 25, this)">x25</button>
                        <button class="setup-btn btn-50" onclick="setMode(1, 50, this)">x50</button>
                        <button class="setup-btn btn-125" onclick="setMode(1, 125, this)">x125</button>
                    </div>
                </div>
                <div class="visual-stage">
                    <div class="question-text" id="qtext-1">Hazır</div>
                    <div class="calc-row" id="grid-1"></div>
                </div>
                <div class="control-bar">
                    <button class="main-btn" id="btn-play-1" onclick="nextStep(1)" disabled>▶ OYNAT</button>
                    <button class="instant-btn" id="btn-quick-1" onclick="instantShow(1)" disabled>⚡ CEVAP</button>
                </div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-header p2-head">
                SORU 2
                <div class="reset-icon" onclick="resetPanel(2)">↺</div>
            </div>
            <div class="panel-content">
                <div class="setup-area" id="setup-2">
                    <input type="number" id="inp-2" class="num-input" value="24">
                    <div class="mode-btns">
                        <button class="setup-btn btn-5" onclick="setMode(2, 5, this)">x5</button>
                        <button class="setup-btn btn-25" onclick="setMode(2, 25, this)">x25</button>
                        <button class="setup-btn btn-50" onclick="setMode(2, 50, this)">x50</button>
                        <button class="setup-btn btn-125" onclick="setMode(2, 125, this)">x125</button>
                    </div>
                </div>
                <div class="visual-stage">
                    <div class="question-text" id="qtext-2">Hazır</div>
                    <div class="calc-row" id="grid-2"></div>
                </div>
                <div class="control-bar">
                    <button class="main-btn" id="btn-play-2" onclick="nextStep(2)" disabled>▶ OYNAT</button>
                    <button class="instant-btn" id="btn-quick-2" onclick="instantShow(2)" disabled>⚡ CEVAP</button>
                </div>
            </div>
        </div>

        <div class="panel">
            <div class="panel-header p3-head">
                SORU 3
                <div class="reset-icon" onclick="resetPanel(3)">↺</div>
            </div>
            <div class="panel-content">
                <div class="setup-area" id="setup-3">
                    <input type="number" id="inp-3" class="num-input" value="16">
                    <div class="mode-btns">
                        <button class="setup-btn btn-5" onclick="setMode(3, 5, this)">x5</button>
                        <button class="setup-btn btn-25" onclick="setMode(3, 25, this)">x25</button>
                        <button class="setup-btn btn-50" onclick="setMode(3, 50, this)">x50</button>
                        <button class="setup-btn btn-125" onclick="setMode(3, 125, this)">x125</button>
                    </div>
                </div>
                <div class="visual-stage">
                    <div class="question-text" id="qtext-3">Hazır</div>
                    <div class="calc-row" id="grid-3"></div>
                </div>
                <div class="control-bar">
                    <button class="main-btn" id="btn-play-3" onclick="nextStep(3)" disabled>▶ OYNAT</button>
                    <button class="instant-btn" id="btn-quick-3" onclick="instantShow(3)" disabled>⚡ CEVAP</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const states = {
            1: { step: 0, factor: 0, div: 0, zeros: "", num: 0 },
            2: { step: 0, factor: 0, div: 0, zeros: "", num: 0 },
            3: { step: 0, factor: 0, div: 0, zeros: "", num: 0 }
        };

        const rules = {
            5: { div: 2, zeros: "0" },
            25: { div: 4, zeros: "00" },
            50: { div: 2, zeros: "00" },
            125: { div: 8, zeros: "000" }
        };

        function setMode(pid, factor, btn) {
            const allBtns = document.querySelectorAll(`#setup-${pid} .setup-btn`);
            allBtns.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');

            const inputVal = document.getElementById(`inp-${pid}`).value;
            if(!inputVal) return;

            states[pid].factor = factor;
            states[pid].num = inputVal;
            states[pid].step = 1;

            document.getElementById(`qtext-${pid}`).innerText = `${inputVal} x ${factor} = ?`;
            document.getElementById(`qtext-${pid}`).style.display = 'block';
            document.getElementById(`grid-${pid}`).innerHTML = '';
            
            const btnPlay = document.getElementById(`btn-play-${pid}`);
            const btnQuick = document.getElementById(`btn-quick-${pid}`);
            btnPlay.disabled = false;
            btnPlay.innerText = "▶ OYNAT";
            btnQuick.disabled = false;
        }

        async function nextStep(pid) {
            const state = states[pid];
            const rule = rules[state.factor];
            const btnPlay = document.getElementById(`btn-play-${pid}`);
            const btnQuick = document.getElementById(`btn-quick-${pid}`);

            if (state.step === 1) {
                // SIFIR EKLEME
                btnPlay.disabled = true;
                btnQuick.disabled = true;

                prepareGrid(pid, state.num, rule.zeros, rule.div);
                
                document.getElementById(`qtext-${pid}`).style.display = 'none';
                document.getElementById(`grid-${pid}`).style.visibility = 'visible';

                const zeroBoxes = document.querySelectorAll(`#grid-${pid} .zero-box`);
                for(let box of zeroBoxes) {
                    await wait(300);
                    box.classList.add('zero-show');
                }

                btnPlay.innerText = "➗ BÖL";
                btnPlay.disabled = false;
                btnQuick.disabled = false;
                state.step = 2;

            } else if (state.step === 2) {
                // BÖLME
                btnPlay.disabled = true;
                btnQuick.disabled = true;

                await autoPlayDivision(pid, state.num + rule.zeros, rule.div);

                btnPlay.innerText = "TEKRAR";
                btnPlay.disabled = false;
                state.step = 3;
            } else if (state.step === 3) {
                resetPanel(pid);
            }
        }

        function instantShow(pid) {
            const state = states[pid];
            if(!state.factor) return;
            const rule = rules[state.factor];
            const fullStr = state.num + rule.zeros;
            const digits = fullStr.split('').map(Number);
            const divisor = rule.div;

            // Çiz
            prepareGrid(pid, state.num, rule.zeros, rule.div);
            document.getElementById(`qtext-${pid}`).style.display = 'none';
            document.getElementById(`grid-${pid}`).style.visibility = 'visible';

            // Sıfırları aç
            const zeroBoxes = document.querySelectorAll(`#grid-${pid} .zero-box`);
            zeroBoxes.forEach(box => {
                box.classList.add('zero-show');
                box.style.transition = 'none';
            });

            // Hesapla ve yaz
            let remainder = 0;
            for(let i=0; i<digits.length; i++) {
                let currentVal = parseInt(remainder.toString() + digits[i].toString());
                let quotient = Math.floor(currentVal / divisor);
                let newRemainder = currentVal % divisor;

                const resBox = document.getElementById(`p${pid}-r-${i}`);
                resBox.innerText = quotient;
                resBox.classList.add('res-show');
                resBox.style.transition = 'none';

                if(i < digits.length - 1 && newRemainder > 0) {
                    const carry = document.getElementById(`p${pid}-c-${i+1}`);
                    carry.innerText = newRemainder;
                    carry.classList.add('carry-show');
                    carry.style.transition = 'none';
                }
                remainder = newRemainder;
            }

            document.getElementById(`btn-play-${pid}`).innerText = "TEKRAR";
            document.getElementById(`btn-play-${pid}`).disabled = false;
            document.getElementById(`btn-quick-${pid}`).disabled = true;
            states[pid].step = 3;
        }

        function prepareGrid(pid, numStr, zeros, divisor) {
            const grid = document.getElementById(`grid-${pid}`);
            grid.innerHTML = '';

            const fullStr = numStr + zeros;
            
            // 1. Önce Rakam Kutuları
            for(let i=0; i < fullStr.length; i++) {
                const isZero = i >= numStr.length;
                const digit = fullStr[i];

                const group = document.createElement('div');
                group.className = 'digit-group';
                
                const carry = document.createElement('div');
                carry.className = 'carry';
                carry.id = `p${pid}-c-${i}`;
                group.appendChild(carry);

                const box = document.createElement('div');
                box.className = `box ${isZero ? 'zero-box' : ''}`;
                box.innerText = digit;
                box.id = `p${pid}-b-${i}`;
                group.appendChild(box);

                const res = document.createElement('div');
                res.className = 'res-box';
                res.id = `p${pid}-r-${i}`;
                group.appendChild(res);

                grid.appendChild(group);
            }

            // 2. En Sona Bölen İşareti (SAĞA)
            const divSign = document.createElement('div');
            divSign.className = 'divider-sign';
            divSign.innerHTML = `÷ ${divisor}`;
            grid.appendChild(divSign);
        }

        async function autoPlayDivision(pid, fullNumberStr, divisor) {
            const digits = fullNumberStr.split('').map(Number);
            let remainder = 0;

            for(let i=0; i < digits.length; i++) {
                const box = document.getElementById(`p${pid}-b-${i}`);
                const resBox = document.getElementById(`p${pid}-r-${i}`);
                
                box.classList.add('active-calc');
                await wait(600);

                let currentVal = parseInt(remainder.toString() + digits[i].toString());
                let quotient = Math.floor(currentVal / divisor);
                let newRemainder = currentVal % divisor;

                resBox.innerText = quotient;
                resBox.classList.add('res-show');
                
                if(i < digits.length - 1 && newRemainder > 0) {
                    const nextCarry = document.getElementById(`p${pid}-c-${i+1}`);
                    await wait(300);
                    nextCarry.innerText = newRemainder;
                    nextCarry.classList.add('carry-show');
                }

                await wait(300);
                box.classList.remove('active-calc');
                remainder = newRemainder;
            }
        }

        function resetPanel(pid) {
            states[pid].step = 0;
            document.getElementById(`qtext-${pid}`).style.display = 'block';
            document.getElementById(`qtext-${pid}`).innerText = 'Hazır';
            document.getElementById(`grid-${pid}`).innerHTML = '';
            document.getElementById(`grid-${pid}`).style.visibility = 'hidden';
            
            const allBtns = document.querySelectorAll(`#setup-${pid} .setup-btn`);
            allBtns.forEach(b => b.classList.remove('active'));
            
            document.getElementById(`btn-play-${pid}`).innerText = "▶ OYNAT";
            document.getElementById(`btn-play-${pid}`).disabled = true;
            document.getElementById(`btn-quick-${pid}`).disabled = true;
        }

        function wait(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>
