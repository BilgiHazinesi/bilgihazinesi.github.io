<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>4-D Mobil Sayı Atölyesi</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #f0f2f5;
            --primary: #2d3436;
            --accent: #6c5ce7;
            --tab-active: #0984e3;
            --white: #ffffff;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 0; width: 100%; height: 100vh;
            background-color: var(--bg); font-family: 'Nunito', sans-serif;
            display: flex; flex-direction: column; overflow: hidden;
        }

        /* --- 1. ÜST KISIM: Sayı Göstergesi --- */
        .top-section {
            background: var(--white); padding: 15px 0;
            border-bottom: 1px solid #ddd;
            box-shadow: var(--shadow); z-index: 10;
            flex-shrink: 0;
        }

        .app-title {
            text-align: center; font-size: 1.2rem; font-weight: 900; color: var(--primary);
            margin-bottom: 10px; opacity: 0.7;
        }

        /* Yatay Kaydırılabilir Sayı Alanı */
        .number-scroller {
            display: flex; justify-content: flex-start; /* Mobilde sola dayalı başlasın */
            overflow-x: auto; padding: 10px 20px;
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch; /* iOS yumuşak kaydırma */
        }
        /* Scrollbar gizle ama fonksiyon kalsın */
        .number-scroller::-webkit-scrollbar { height: 4px; }
        .number-scroller::-webkit-scrollbar-thumb { background: #ccc; border-radius: 4px; }

        .digit-group {
            display: flex; margin-right: 15px; position: relative;
            padding-top: 15px; /* Etiket için yer */
        }
        
        .group-label {
            position: absolute; top: -5px; left: 0; width: 100%; text-align: center;
            font-size: 0.65rem; font-weight: 800; color: #aaa; text-transform: uppercase; letter-spacing: 1px;
        }

        .digit-box {
            width: 45px; height: 60px; margin: 0 2px;
            background: #f1f2f6; border-radius: 8px;
            display: flex; justify-content: center; align-items: center;
            font-size: 2.2rem; font-weight: 900; color: var(--primary);
            border-bottom: 4px solid #dcdde1; cursor: pointer; transition: 0.2s;
        }

        /* Aktif Rakam */
        .digit-box.active {
            background: #ffeaa7; color: #d35400;
            border-bottom-color: #e67e22; transform: translateY(-5px);
        }
        
        /* Bölük Renkleri */
        .g-birler .digit-box { color: #00b894; }
        .g-binler .digit-box { color: #0984e3; }
        .g-milyon .digit-box { color: #d63031; }
        .g-milyar .digit-box { color: #6c5ce7; }

        /* --- 2. ORTA KISIM: Sekmeler (Tabs) --- */
        .tab-nav {
            display: flex; background: #dfe6e9; padding: 5px;
            justify-content: space-around; flex-shrink: 0;
        }
        
        .tab-btn {
            flex: 1; padding: 12px; border: none; background: transparent;
            font-weight: 800; font-size: 0.95rem; color: #636e72;
            border-radius: 8px; cursor: pointer; transition: 0.3s;
            display: flex; flex-direction: column; align-items: center; gap: 5px;
        }
        
        .tab-btn i { font-size: 1.2rem; }
        
        .tab-btn.active {
            background: var(--white); color: var(--tab-active);
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* --- 3. ALT KISIM: İçerik Alanı --- */
        .content-area {
            flex: 1; overflow-y: auto; padding: 20px; position: relative;
            background: #f8f9fa;
        }

        .tab-content { display: none; animation: fadeIn 0.3s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from{opacity:0; transform:translateY(10px)} to{opacity:1; transform:translateY(0)} }

        /* --- TAB 1: ANALİZ KARTLARI --- */
        .info-card {
            background: var(--white); padding: 20px; border-radius: 15px;
            box-shadow: var(--shadow); margin-bottom: 15px; text-align: center;
        }
        .card-label { color: #b2bec3; font-weight: 800; font-size: 0.8rem; text-transform: uppercase; margin-bottom: 5px; }
        .card-val { font-family: 'Patrick Hand', cursive; font-size: 1.8rem; color: var(--primary); font-weight: bold; }
        .big-text { font-size: 2.5rem; color: #0984e3; }
        .reading-text { font-size: 1.2rem; line-height: 1.4; color: #636e72; }

        /* --- TAB 2: RENKLİ MERDİVEN --- */
        .ladder-container {
            display: flex; flex-direction: column; align-items: flex-end; gap: 8px; padding-bottom: 50px;
        }
        
        .ladder-step {
            padding: 10px 20px; border-radius: 10px 0 0 10px;
            color: white; font-weight: bold; font-family: 'Courier New', monospace; font-size: 1.2rem;
            box-shadow: 3px 3px 10px rgba(0,0,0,0.1);
            transform-origin: right center; animation: slideIn 0.5s backwards;
            display: flex; align-items: center; justify-content: space-between;
            width: auto; min-width: 100px;
        }
        
        .step-eq { font-size: 0.8rem; opacity: 0.8; margin-right: 10px; font-family: 'Nunito', sans-serif; }

        @keyframes slideIn { from{transform: scaleX(0); opacity:0;} to{transform: scaleX(1); opacity:1;} }

        /* --- TAB 3: AYARLAR --- */
        .settings-group {
            background: white; padding: 20px; border-radius: 15px; box-shadow: var(--shadow);
        }
        .btn-big {
            width: 100%; padding: 15px; border: none; border-radius: 12px;
            background: var(--accent); color: white; font-size: 1.2rem; font-weight: bold;
            margin-top: 15px; cursor: pointer; box-shadow: 0 4px 0 #4834d4;
        }
        .btn-big:active { transform: translateY(4px); box-shadow: none; }
        
        select {
            width: 100%; padding: 12px; border-radius: 8px; border: 2px solid #dfe6e9;
            font-size: 1.1rem; font-weight: bold; background: #fff;
        }

    </style>
</head>
<body>

    <div class="top-section">
        <div class="app-title">4-D Sayı Atölyesi</div>
        <div class="number-scroller" id="display-area">
            </div>
    </div>

    <div class="tab-nav">
        <button class="tab-btn active" onclick="switchTab('analiz')">
            <i class="fas fa-microscope"></i> Analiz
        </button>
        <button class="tab-btn" onclick="switchTab('merdiven')">
            <i class="fas fa-stream"></i> Merdiven
        </button>
        <button class="tab-btn" onclick="switchTab('ayarlar')">
            <i class="fas fa-cogs"></i> Ayarlar
        </button>
    </div>

    <div class="content-area">
        
        <div id="tab-analiz" class="tab-content active">
            <div class="info-card" id="intro-msg" style="background:#fff3cd; color:#856404;">
                <i class="fas fa-hand-pointer"></i> Yukarıdaki sayıdan bir rakama tıkla!
            </div>

            <div id="detail-panel" style="display:none;">
                <div class="info-card">
                    <div class="card-label">Seçilen Basamak</div>
                    <div class="card-val" id="lbl-basamak-adi">...</div>
                </div>
                
                <div style="display:flex; gap:10px;">
                    <div class="info-card" style="flex:1">
                        <div class="card-label">Sayı Değeri</div>
                        <div class="card-val big-text" id="lbl-sayi-degeri">0</div>
                    </div>
                    <div class="info-card" style="flex:1">
                        <div class="card-label">Basamak Değeri</div>
                        <div class="card-val big-text" id="lbl-basamak-degeri" style="font-size:1.8rem; color:#d63031">0</div>
                    </div>
                </div>

                <div class="info-card">
                    <div class="card-label">Sayının Okunuşu</div>
                    <div class="card-val reading-text" id="lbl-okunus">...</div>
                </div>
            </div>
        </div>

        <div id="tab-merdiven" class="tab-content">
            <div style="text-align:center; color:#b2bec3; margin-bottom:15px; font-size:0.9rem;">
                Basamak değerleri toplamı sayının kendisine eşittir.
            </div>
            <div class="ladder-container" id="ladder-area">
                </div>
            <div class="info-card">
                <div class="card-label">Çözümleme</div>
                <div class="reading-text" id="lbl-cozumleme" style="font-size:1rem; text-align:left;">...</div>
            </div>
        </div>

        <div id="tab-ayarlar" class="tab-content">
            <div class="settings-group">
                <label style="display:block; margin-bottom:10px; font-weight:bold; color:#636e72">Basamak Sayısı:</label>
                <select id="digit-select">
                    <option value="4">4 Basamaklı (Binler)</option>
                    <option value="5">5 Basamaklı (On Binler)</option>
                    <option value="6">6 Basamaklı (Yüz Binler)</option>
                    <option value="7">7 Basamaklı (Milyonlar)</option>
                    <option value="8">8 Basamaklı (On Milyonlar)</option>
                    <option value="9" selected>9 Basamaklı (Yüz Milyonlar)</option>
                    <option value="10">10 Basamaklı (Milyarlar)</option>
                    <option value="12">12 Basamaklı (Yüz Milyarlar)</option>
                </select>
                
                <button class="btn-big" onclick="generateNumber()">
                    <i class="fas fa-random"></i> Yeni Sayı Oluştur
                </button>
            </div>
            
            <div class="info-card" style="margin-top:20px;">
                <div class="card-label">Öğrenci Notu</div>
                <p style="color:#636e72">Sayıları bölüklerine ayırarak okumak işimizi kolaylaştırır.</p>
            </div>
        </div>

    </div>

<script>
    // === VERİ VE AYARLAR ===
    let currentNumberStr = "";
    const basamakAdlari = [
        "Birler", "Onlar", "Yüzler",
        "Binler", "On Binler", "Yüz Binler",
        "Milyonlar", "On Milyonlar", "Yüz Milyonlar",
        "Milyarlar", "On Milyarlar", "Yüz Milyarlar"
    ];
    
    // Canlı renk paleti (Merdiven için)
    const rainbowColors = [
        "#e17055", "#00b894", "#0984e3", "#6c5ce7", 
        "#fdcb6e", "#d63031", "#e84393", "#00cec9",
        "#636e72", "#2d3436", "#b2bec3", "#dfe6e9"
    ];

    // === TEMEL FONKSİYONLAR ===

    function switchTab(tabName) {
        // 1. Butonları güncelle
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        // İlgili butonu bulmak için basit bir loop ya da event target kullanılabilir ama burada manuel indexleme yerine isme göre gidiyoruz
        // Basitlik adına onclick içine yazdık.
        const buttons = document.querySelectorAll('.tab-btn');
        if(tabName === 'analiz') buttons[0].classList.add('active');
        if(tabName === 'merdiven') buttons[1].classList.add('active');
        if(tabName === 'ayarlar') buttons[2].classList.add('active');

        // 2. İçeriği güncelle
        document.querySelectorAll('.tab-content').forEach(div => div.classList.remove('active'));
        document.getElementById(`tab-${tabName}`).classList.add('active');
    }

    function generateNumber() {
        const digits = parseInt(document.getElementById('digit-select').value);
        
        // İlk hane 0 olamaz
        let numStr = Math.floor(Math.random() * 9 + 1).toString();
        for(let i=1; i<digits; i++) {
            numStr += Math.floor(Math.random() * 10).toString();
        }
        currentNumberStr = numStr;

        renderDisplay();
        renderLadder();
        
        // Analiz ekranını sıfırla ama okunuşu güncelle
        document.getElementById('detail-panel').style.display = 'none';
        document.getElementById('intro-msg').style.display = 'block';
        
        // Kullanıcıya kolaylık olsun diye Analiz sekmesine dön (mobilde olduğumuz için ayarlar sekmesinde kalmasın)
        switchTab('analiz');
    }

    function formatNumber(num) {
        return num.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
    }

    // === GÖRSELLEŞTİRME (RENDER) ===

    function renderDisplay() {
        const container = document.getElementById('display-area');
        container.innerHTML = '';

        // Sayıyı tersten grupla
        let len = currentNumberStr.length;
        let groups = [];
        let currentGroup = [];
        
        for(let i=len-1; i>=0; i--) {
            currentGroup.unshift({ val: currentNumberStr[i], idx: i });
            if(currentGroup.length === 3 || i === 0) {
                groups.unshift(currentGroup);
                currentGroup = [];
            }
        }

        // Grupları ekrana bas
        groups.forEach((group, gIndex) => {
            // Bölük adı bulma (Tersten index: 0=Birler, 1=Binler...)
            let periodIdx = groups.length - 1 - gIndex;
            let periodName = "";
            let colorClass = "";

            if(periodIdx === 0) { periodName = "BİRLER"; colorClass = "g-birler"; }
            else if(periodIdx === 1) { periodName = "BİNLER"; colorClass = "g-binler"; }
            else if(periodIdx === 2) { periodName = "MİLYONLAR"; colorClass = "g-milyon"; }
            else if(periodIdx === 3) { periodName = "MİLYARLAR"; colorClass = "g-milyar"; }

            let gDiv = document.createElement('div');
            gDiv.className = `digit-group ${colorClass}`;
            
            let lbl = document.createElement('div');
            lbl.className = 'group-label';
            lbl.innerText = periodName;
            gDiv.appendChild(lbl);

            group.forEach(item => {
                let box = document.createElement('div');
                box.className = 'digit-box';
                box.innerText = item.val;
                box.id = `d-${item.idx}`;
                box.onclick = () => selectDigit(item.idx, item.val);
                gDiv.appendChild(box);
            });

            container.appendChild(gDiv);
        });
    }

    function selectDigit(index, val) {
        // 1. Görsel Seçim
        document.querySelectorAll('.digit-box').forEach(b => b.classList.remove('active'));
        document.getElementById(`d-${index}`).classList.add('active');

        // 2. Matematiksel Hesap
        let len = currentNumberStr.length;
        let power = len - 1 - index; // 10^power
        let basamakDegeri = parseInt(val) * Math.pow(10, power);
        
        // 3. UI Güncelle
        document.getElementById('intro-msg').style.display = 'none';
        document.getElementById('detail-panel').style.display = 'block';
        
        document.getElementById('lbl-basamak-adi').innerText = basamakAdlari[power] + " Basamağı";
        document.getElementById('lbl-sayi-degeri').innerText = val;
        document.getElementById('lbl-basamak-degeri').innerText = formatNumber(basamakDegeri);
        
        // Tüm sayının okunuşu
        document.getElementById('lbl-okunus').innerText = numberToText(parseInt(currentNumberStr));
        
        // Analiz sekmesini aç (Eğer başka sekmedeyse)
        switchTab('analiz');
    }

    function renderLadder() {
        const container = document.getElementById('ladder-area');
        container.innerHTML = '';
        
        let len = currentNumberStr.length;
        let expansionParts = [];

        for(let i=0; i<len; i++) {
            let digit = parseInt(currentNumberStr[i]);
            let power = len - 1 - i;
            let placeVal = digit * Math.pow(10, power);
            
            // 0 olan basamakları göstermeyelim (Merdiven temiz olsun) veya hepsini gösterelim.
            // Öğretim amaçlı hepsini göstermek daha iyidir ama değer 0 ise görsel olarak silik yapabiliriz.
            
            let step = document.createElement('div');
            step.className = 'ladder-step';
            // Renk döngüsü
            step.style.backgroundColor = rainbowColors[power % rainbowColors.length];
            // Genişlik ayarı (Basamak değerine göre görsel uzunluk)
            // Basit bir logaritmik genişlik verelim ki çok taşmasın
            let widthPercent = 30 + (power * 6); 
            if(widthPercent > 100) widthPercent = 100;
            step.style.width = widthPercent + "%";
            
            // Gecikmeli animasyon
            step.style.animationDelay = (i * 0.1) + "s";

            step.innerHTML = `
                <span class="step-eq">${digit} x 10<sup>${power}</sup></span>
                <span>${formatNumber(placeVal)}</span>
            `;
            
            container.appendChild(step);

            if(digit > 0) {
                expansionParts.push(`(${digit} x ${Math.pow(10, power).toLocaleString()})`);
            }
        }

        document.getElementById('lbl-cozumleme').innerHTML = expansionParts.join(' + ');
    }

    // === YARDIMCI: OKUNUŞ ===
    function numberToText(num) {
        if(num === 0) return "Sıfır";
        const birler = ["","Bir","İki","Üç","Dört","Beş","Altı","Yedi","Sekiz","Dokuz"];
        const onlar = ["","On","Yirmi","Otuz","Kırk","Elli","Altmış","Yetmiş","Seksen","Doksan"];
        const binler = ["","Bin","Milyon","Milyar","Trilyon"];
        
        let strNum = num.toString();
        let parts = [];
        while(strNum.length > 0) {
            parts.push(strNum.slice(-3));
            strNum = strNum.slice(0, -3);
        }
        
        let text = "";
        for(let i=parts.length-1; i>=0; i--) {
            let n = parseInt(parts[i]);
            if(n > 0) {
                let subText = "";
                let y = Math.floor(n/100);
                let o = Math.floor((n%100)/10);
                let b = n%10;
                
                if(y === 1) subText += "Yüz ";
                else if(y > 1) subText += birler[y] + " Yüz ";
                
                subText += onlar[o] + " ";
                subText += birler[b] + " ";
                
                if(i === 1 && n === 1) subText = ""; // Bir Bin denmez
                
                text += subText + binler[i] + " ";
            }
        }
        return text.trim();
    }

    // Başlat
    generateNumber();

</script>
</body>
</html>
