<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fen Bilimleri: MÄ±knatÄ±s EtkileÅŸimleri</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --n-color: #e74c3c; /* KÄ±rmÄ±zÄ± */
            --s-color: #2980b9; /* Mavi */
            --bg-color: #ecf0f1;
            --panel-bg: white;
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            user-select: none;
        }

        /* MENÃœ */
        .nav {
            display: flex; gap: 15px; margin-bottom: 20px;
        }
        .nav-btn {
            padding: 12px 30px; border: none; border-radius: 50px; cursor: pointer;
            font-size: 1.1rem; font-weight: bold; color: #555; background: white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1); transition: 0.3s;
        }
        .nav-btn.active { background: #2c3e50; color: white; transform: scale(1.05); }

        /* PANELLER */
        .panel { display: none; width: 100%; max-width: 1000px; animation: popIn 0.3s; }
        .panel.active { display: block; }
        @keyframes popIn { from {opacity: 0; transform: translateY(10px);} to {opacity: 1; transform: translateY(0);} }

        /* KART TASARIMI */
        .card {
            background: white; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 20px; position: relative; border: 4px solid #34495e; overflow: hidden;
            display: flex; flex-direction: column; align-items: center;
        }
        .card-title { font-size: 1.5rem; color: #2c3e50; margin-bottom: 10px; border-bottom: 3px solid #f1c40f; padding-bottom: 5px;}

        /* --- MIKNATIS STÄ°LLERÄ° --- */
        .mag-box {
            width: 80px; height: 120px; display: flex; flex-direction: column;
            border-radius: 6px; overflow: hidden; font-weight: bold; color: white; font-size: 1.5rem;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); position: absolute; z-index: 5;
            border: 2px solid white;
        }
        /* Yatay MÄ±knatÄ±s */
        .mag-box.hor {
            width: 120px; height: 50px; flex-direction: row;
        }
        
        .pole { flex: 1; display: flex; align-items: center; justify-content: center; width: 100%; height: 100%; transition: background 0.2s;}
        .pole.n { background-color: var(--n-color); }
        .pole.s { background-color: var(--s-color); }

        /* Butonlar */
        .btn-ctrl {
            margin-top: auto; padding: 10px 20px; background: #f39c12; color: white; 
            border: none; border-radius: 8px; cursor: pointer; font-weight: bold; font-family: 'Fredoka';
            box-shadow: 0 4px 0 #d35400; transition: transform 0.1s; z-index: 20;
        }
        .btn-ctrl:active { transform: translateY(4px); box-shadow: none; }

        /* --- YAY Ã–ZEL --- */
        #spring-container { width: 100%; height: 500px; position: relative; background: radial-gradient(#ddd 1px, white 1px) 0 0 / 20px 20px; }
        #spring-svg { 
            position: absolute; top: 0; left: 50%; transform: translateX(-50%); 
            overflow: visible; z-index: 1; 
        }
        #spring-path {
            fill: none; stroke: #555; stroke-width: 6; stroke-linecap: round; stroke-linejoin: round;
        }
        
        /* AsÄ±lÄ± MÄ±knatÄ±s */
        #s-mag-top { top: 120px; left: 50%; transform: translateX(-50%); } 
        /* Hareketli MÄ±knatÄ±s */
        #s-mag-bot { top: 350px; left: 50%; transform: translateX(-50%); cursor: ns-resize; }

        /* --- Ä°P Ã–ZEL --- */
        #string-container { width: 100%; height: 450px; position: relative; background: #fff; }
        .ceiling { width: 100%; height: 20px; background: repeating-linear-gradient(45deg, #333, #333 10px, #444 10px, #444 20px); position: absolute; top: 0; }
        
        .pendulum-wrapper {
            position: absolute; top: 20px; height: 250px; width: 2px;
            transform-origin: top center; /* DÃ¶nme noktasÄ± tavan */
            transition: transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .string-line { width: 4px; height: 100%; background: #333; margin: 0 auto; }
        .mag-hanging { position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); }

        /* Sol sabit, SaÄŸ hareketli */
        #p-left { left: 30%; }
        #p-right { left: 70%; cursor: ew-resize; }
        #p-right::after { content: 'â†” SÃ¼rÃ¼kle'; position: absolute; top: 50%; left: 20px; background: #eee; padding: 2px 5px; font-size: 0.8rem; border-radius: 4px; pointer-events: none;}

        .controls-row {
            position: absolute; bottom: 20px; width: 100%; display: flex; justify-content: center; gap: 20px;
        }

    </style>
</head>
<body>

    <div class="nav">
        <button class="nav-btn active" onclick="setMode('spring')">1. Yay Sorusu</button>
        <button class="nav-btn" onclick="setMode('string')">2. Ä°p (SarkaÃ§) Sorusu</button>
    </div>

    <div id="panel-spring" class="panel active">
        <div class="card">
            <div class="card-title">Yay UzamasÄ± ve KÄ±salmasÄ±</div>
            <p style="text-align: center; color: #777;">Alttaki mÄ±knatÄ±sÄ± tutup yukarÄ±-aÅŸaÄŸÄ± sÃ¼rÃ¼kleyin. KutuplarÄ± Ã§evirip yayÄ± izleyin.</p>
            
            <div id="spring-container">
                <svg id="spring-svg" width="60" height="400">
                    <path id="spring-path" d="" />
                </svg>

                <div id="s-mag-top" class="mag-box">
                    <div class="pole s">S</div>
                    <div class="pole n">N</div>
                </div>

                <div id="s-mag-bot" class="mag-box">
                    <div class="pole s">S</div>
                    <div class="pole n">N</div>
                </div>
            </div>

            <div class="controls-row">
                 <button class="btn-ctrl" onclick="flipMag('s-mag-top')">Ãœst MÄ±knatÄ±sÄ± Ã‡evir ðŸ”„</button>
                 <button class="btn-ctrl" style="background:#27ae60; box-shadow: 0 4px 0 #2ecc71;" onclick="flipMag('s-mag-bot')">Alt MÄ±knatÄ±sÄ± Ã‡evir ðŸ”„</button>
            </div>
        </div>
    </div>

    <div id="panel-string" class="panel">
        <div class="card">
            <div class="card-title">SarkaÃ§ Deneyi (Ä°tme - Ã‡ekme)</div>
            <p style="text-align: center; color: #777;">SaÄŸdaki ipi tutun ve sola doÄŸru yaklaÅŸtÄ±rÄ±n. Ä°plerin aÃ§Ä±sÄ±na dikkat!</p>
            
            <div id="string-container">
                <div class="ceiling"></div>

                <div id="p-left" class="pendulum-wrapper">
                    <div class="string-line"></div>
                    <div id="mag-p-left" class="mag-box hor mag-hanging">
                        <div class="pole n">N</div>
                        <div class="pole s">S</div>
                    </div>
                </div>

                <div id="p-right" class="pendulum-wrapper">
                    <div class="string-line"></div>
                    <div id="mag-p-right" class="mag-box hor mag-hanging">
                        <div class="pole n">N</div>
                        <div class="pole s">S</div>
                    </div>
                </div>
            </div>

            <div class="controls-row">
                <button class="btn-ctrl" onclick="flipPendulum('mag-p-left')">Solu Ã‡evir ðŸ”„</button>
                <button class="btn-ctrl" style="background:#27ae60; box-shadow: 0 4px 0 #2ecc71;" onclick="flipPendulum('mag-p-right')">SaÄŸÄ± Ã‡evir ðŸ”„</button>
            </div>
        </div>
    </div>

    <script>
        // --- NAVÄ°GASYON ---
        function setMode(mode) {
            document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            
            if(mode === 'spring') {
                document.getElementById('panel-spring').classList.add('active');
                document.querySelectorAll('.nav-btn')[0].classList.add('active');
                updateSpringVisuals(); // GÃ¶rÃ¼nÃ¼r olunca Ã§izimi yenile
            } else {
                document.getElementById('panel-string').classList.add('active');
                document.querySelectorAll('.nav-btn')[1].classList.add('active');
            }
        }

        /* ----------------------------------------------------
           1. YAY SÄ°MÃœLASYONU KODLARI
           ---------------------------------------------------- */
        const sTop = document.getElementById('s-mag-top');
        const sBot = document.getElementById('s-mag-bot');
        const sPath = document.getElementById('spring-path');
        const sContainer = document.getElementById('spring-container');
        
        let sDragging = false;
        
        // KutuplarÄ±n Durumu (TRUE: Ters Ã‡evrilmiÅŸ / S-N)
        let sState = {
            's-mag-top': false, // VarsayÄ±lan: S(Ã¼st) - N(alt)
            's-mag-bot': false  // VarsayÄ±lan: S(Ã¼st) - N(alt)
        };

        // Hareket OlaylarÄ±
        sBot.addEventListener('mousedown', startDragS);
        sBot.addEventListener('touchstart', startDragS, {passive:false});
        window.addEventListener('mousemove', dragS);
        window.addEventListener('touchmove', dragS, {passive:false});
        window.addEventListener('mouseup', stopDragS);
        window.addEventListener('touchend', stopDragS);

        function startDragS(e) { sDragging = true; }
        function stopDragS() { sDragging = false; }
        
        function dragS(e) {
            if(!sDragging) return;
            e.preventDefault(); // Telefondaki kaydÄ±rmayÄ± engelle
            const rect = sContainer.getBoundingClientRect();
            const clientY = e.clientY || e.touches[0].clientY;
            
            let y = clientY - rect.top - 60; // 60 = mÄ±knatÄ±s yarÄ± boyu
            
            // SÄ±nÄ±rlar (MÄ±knatÄ±slar iÃ§ iÃ§e geÃ§mesin)
            if(y < 220) y = 220; 
            if(y > 400) y = 400;

            sBot.style.top = y + 'px';
            updateSpringVisuals();
        }

        function flipMag(id) {
            sState[id] = !sState[id]; // Durumu tersine Ã§evir
            const el = document.getElementById(id);
            
            if(sState[id]) {
                // TERS DURUM: N Ãœstte, S Altta
                el.innerHTML = '<div class="pole n">N</div><div class="pole s">S</div>';
            } else {
                // NORMAL DURUM: S Ãœstte, N Altta
                el.innerHTML = '<div class="pole s">S</div><div class="pole n">N</div>';
            }
            updateSpringVisuals();
        }

        function updateSpringVisuals() {
            // MÄ±knatÄ±slarÄ±n birbirine bakan yÃ¼zleri
            // Ãœst MÄ±knatÄ±sÄ±n AltÄ±: Normal(N), Ters(S)
            let topPole = sState['s-mag-top'] ? 'S' : 'N';
            
            // Alt MÄ±knatÄ±sÄ±n ÃœstÃ¼: Normal(S), Ters(N)
            let botPole = sState['s-mag-bot'] ? 'N' : 'S';

            // ZÄ±t kutuplar (N-S veya S-N) -> Ã‡eker
            let isAttracting = (topPole !== botPole);

            // Mesafe HesabÄ±
            let topMagY = 120; // Sabit
            let botMagY = parseInt(sBot.style.top || 350);
            let dist = botMagY - (topMagY + 120); // 120 mÄ±knatÄ±s boyu

            let forceEffect = 0;
            // Mesafe 200px'den azsa etkileÅŸim baÅŸlar
            if(dist < 200) {
                let rawForce = (200 - dist) / 2.5; 
                if(isAttracting) {
                    forceEffect = rawForce; // Ã‡ekme -> Yay Uzar (AÅŸaÄŸÄ± iner)
                } else {
                    forceEffect = -rawForce; // Ä°tme -> Yay KÄ±salÄ±r (YukarÄ± Ã§Ä±kar)
                }
            }

            // Ãœst mÄ±knatÄ±sÄ±n yeni konumu (Yay esnemesi)
            let newTopY = 120 + forceEffect;
            sTop.style.top = newTopY + 'px';

            // YAYI Ã‡Ä°Z (Sarmal GÃ¶rÃ¼nÃ¼m)
            // Yay, 0'dan newTopY'ye kadar Ã§izilecek.
            // Zigzag fonksiyonu
            let h = newTopY;
            let coils = 12; // SarÄ±m sayÄ±sÄ±
            let width = 40; // Yay geniÅŸliÄŸi
            
            let pathData = `M 30 0 `; // BaÅŸlangÄ±Ã§ (Ortadan)
            
            for(let i=1; i<=coils; i++) {
                let yStep = h / coils;
                let x = (i % 2 === 0) ? 50 : 10; // SaÄŸ-Sol
                let y = i * yStep;
                pathData += `L ${x} ${y} `;
            }
            
            pathData += `L 30 ${h}`; // BitiÅŸ (Ortaya)
            
            sPath.setAttribute('d', pathData);
        }


        /* ----------------------------------------------------
           2. Ä°P (SARKAÃ‡) SÄ°MÃœLASYONU KODLARI
           ---------------------------------------------------- */
        const pLeft = document.getElementById('p-left');
        const pRight = document.getElementById('p-right');
        const strContainer = document.getElementById('string-container');
        
        let pDragging = false;

        // Kutuplar Durumu
        let pState = {
            'mag-p-left': false, // Normal: N(sol) - S(saÄŸ)
            'mag-p-right': false // Normal: N(sol) - S(saÄŸ)
        };

        // SaÄŸ ipi sÃ¼rÃ¼kleme
        pRight.addEventListener('mousedown', () => pDragging = true);
        pRight.addEventListener('touchstart', () => pDragging = true, {passive:false});
        window.addEventListener('mousemove', dragPendulum);
        window.addEventListener('touchmove', dragPendulum, {passive:false});
        window.addEventListener('mouseup', () => pDragging = false);
        window.addEventListener('touchend', () => pDragging = false);

        function dragPendulum(e) {
            if(!pDragging) return;
            e.preventDefault();
            const rect = strContainer.getBoundingClientRect();
            const clientX = e.clientX || e.touches[0].clientX;
            
            // YÃ¼zdelik hesap (Responsive olsun diye)
            let xPerc = ((clientX - rect.left) / rect.width) * 100;
            
            // SÄ±nÄ±rlar (Sol ipe Ã§arpmasÄ±n)
            if(xPerc < 40) xPerc = 40;
            if(xPerc > 90) xPerc = 90;

            pRight.style.left = xPerc + '%';
            updatePendulumPhysics();
        }

        function flipPendulum(id) {
            pState[id] = !pState[id];
            const el = document.getElementById(id);
            
            if(pState[id]) {
                // TERS: S(sol) - N(saÄŸ)
                el.innerHTML = '<div class="pole s">S</div><div class="pole n">N</div>';
            } else {
                // NORMAL: N(sol) - S(saÄŸ)
                el.innerHTML = '<div class="pole n">N</div><div class="pole s">S</div>';
            }
            updatePendulumPhysics();
        }

        function updatePendulumPhysics() {
            // MÄ±knatÄ±slarÄ±n birbirine bakan yÃ¼zleri (Ä°Ã§ taraflar)
            
            // SOL SarkaÃ§: SaÄŸ ucu iÃ§e bakÄ±yor.
            // Normal(N-S) -> S bakÄ±yor. Ters(S-N) -> N bakÄ±yor.
            let leftInner = pState['mag-p-left'] ? 'N' : 'S';

            // SAÄž SarkaÃ§: Sol ucu iÃ§e bakÄ±yor.
            // Normal(N-S) -> N bakÄ±yor. Ters(S-N) -> S bakÄ±yor.
            let rightInner = pState['mag-p-right'] ? 'S' : 'N';

            // ZIT KUTUPLAR (Ã–rn: S ve N) -> Ã‡EKER
            // AYNI KUTUPLAR (Ã–rn: S ve S) -> Ä°TER
            let isAttracting = (leftInner !== rightInner);

            // Mesafe HesabÄ± (YÃ¼zde Ã¼zerinden basit yaklaÅŸÄ±m)
            let leftX = 30; 
            let rightX = parseFloat(pRight.style.left || 70);
            let dist = rightX - leftX;

            let angle = 0;
            // Mesafe 35 birimden azsa etkileÅŸim baÅŸlar
            if(dist < 35) {
                let factor = (35 - dist) * 1.5; // GÃ¼Ã§ faktÃ¶rÃ¼
                if(factor > 25) factor = 25; // Max aÃ§Ä±
                angle = factor;
            }

            if(isAttracting) {
                // Ã‡EKME: Ä°pler birbirine yaklaÅŸÄ±r (Ä°Ã§e eÄŸim)
                // Sol sarkaÃ§: Saat yÃ¶nÃ¼ (+) | SaÄŸ sarkaÃ§: Ters saat yÃ¶nÃ¼ (-)
                pLeft.style.transform = `rotate(${angle}deg)`;
                pRight.style.transform = `rotate(${-angle}deg)`;
            } else {
                // Ä°TME: Ä°pler birbirinden kaÃ§ar (DÄ±ÅŸa eÄŸim)
                // Sol sarkaÃ§: Ters saat yÃ¶nÃ¼ (-) | SaÄŸ sarkaÃ§: Saat yÃ¶nÃ¼ (+)
                pLeft.style.transform = `rotate(${-angle}deg)`;
                pRight.style.transform = `rotate(${angle}deg)`;
            }
        }

        // BaÅŸlangÄ±Ã§ta Ã§izimi yap
        updateSpringVisuals();

    </script>
</body>
</html>
