<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GerÃ§ekÃ§i MÄ±knatÄ±s LaboratuvarÄ± V3</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --n-color: #ff3b30; /* CanlÄ± KÄ±rmÄ±zÄ± */
            --s-color: #007aff; /* CanlÄ± Mavi */
            --bg-color: #f2f2f7;
            --text-color: #1c1c1e;
        }

        body {
            font-family: 'Fredoka', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            user-select: none;
        }

        h1 { margin-bottom: 5px; font-size: 2.2rem; color: #333; }
        p.desc { color: #666; margin-bottom: 20px; }

        /* TAB STÄ°LÄ° */
        .tabs { background: #e5e5ea; padding: 5px; border-radius: 15px; display: flex; gap: 5px; margin-bottom: 20px; }
        .tab-btn {
            border: none; background: transparent; padding: 10px 25px; border-radius: 10px;
            font-family: 'Fredoka', sans-serif; font-size: 1.1rem; cursor: pointer; color: #8e8e93; transition: 0.3s;
        }
        .tab-btn.active { background: white; color: #000; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .tab-content { display: none; width: 100%; max-width: 900px; animation: fadeEffect 0.5s; }
        .tab-content.active { display: block; }
        @keyframes fadeEffect { from {opacity: 0;} to {opacity: 1;} }

        .card { background: white; border-radius: 20px; padding: 30px; box-shadow: 0 10px 40px rgba(0,0,0,0.05); min-height: 400px; position: relative; }

        /* --- GALERÄ° STÄ°LLERÄ° --- */
        .gallery-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 40px; justify-items: center; padding: 20px; }
        .magnet-showcase { display: flex; flex-direction: column; align-items: center; gap: 15px; }
        .label { font-weight: 600; color: #555; }

        /* --- Ä°NTERAKTÄ°F FÄ°ZÄ°K ALANI --- */
        #physics-zone {
            height: 450px; background-color: #eef1f5; border-radius: 15px; position: relative; overflow: hidden; border: 2px solid #d1d1d6;
            background-image: radial-gradient(#d1d1d6 1px, transparent 1px); background-size: 20px 20px; /* Izgara gÃ¶rÃ¼nÃ¼mÃ¼ */
        }

        .magnet-obj {
            height: 60px; display: flex; position: absolute; border-radius: 6px; 
            box-shadow: 0 8px 15px rgba(0,0,0,0.2); font-size: 1.5rem; color: white; font-weight: bold;
            align-items: center; justify-content: center; z-index: 10;
        }
        
        .pole { width: 50%; height: 100%; display: flex; align-items: center; justify-content: center; }
        .pole.n { background: var(--n-color); }
        .pole.s { background: var(--s-color); }
        
        /* Sabit MÄ±knatÄ±s */
        #static-mag { width: 200px; left: 50px; top: 195px; cursor: not-allowed; border: 3px solid #333; }
        
        /* Hareketli MÄ±knatÄ±s */
        #dynamic-mag { width: 200px; left: 500px; top: 195px; cursor: grab; transition: transform 0.1s; }
        #dynamic-mag:active { cursor: grabbing; transform: scale(1.02); }
        #dynamic-mag.flipped { flex-direction: row-reverse; }

        /* Kuvvet AlanÄ± GÃ¶rselleri */
        .force-arrow {
            position: absolute; font-size: 30px; font-weight: 900; opacity: 0; transition: opacity 0.2s; pointer-events: none; z-index: 5;
        }

        .controls { display: flex; justify-content: center; gap: 15px; margin-top: 20px; }
        button.action-btn {
            background: #333; color: white; border: none; padding: 12px 24px; border-radius: 12px; font-size: 1rem; cursor: pointer; font-family: 'Fredoka', sans-serif;
        }
        button.action-btn:hover { background: #000; }
        button.flip-btn { background: #ff9f0a; }

        /* --- KIRILMA DENEYÄ° --- */
        .break-zone { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 300px; gap: 30px; }
        
        .bar-magnet-large {
            width: 400px; height: 80px; display: flex; border-radius: 8px; overflow: hidden; box-shadow: 0 10px 20px rgba(0,0,0,0.15); font-size: 2rem; font-weight: bold; color: white;
        }
        
        .broken-wrapper { display: flex; gap: 40px; }
        
        .half-magnet {
            width: 180px; height: 80px; display: flex; border-radius: 8px; overflow: hidden; box-shadow: 0 10px 20px rgba(0,0,0,0.15); font-size: 1.5rem; font-weight: bold; color: white;
            animation: snapBreak 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes snapBreak {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

    </style>
</head>
<body>

    <h1>ğŸ§² MÄ±knatÄ±s UstasÄ±</h1>
    <p class="desc">4. SÄ±nÄ±f Fen Bilimleri Ä°nteraktif AtÃ¶lyesi</p>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('tab1', this)">MÄ±knatÄ±s Ã‡eÅŸitleri</button>
        <button class="tab-btn" onclick="switchTab('tab2', this)">Ã‡ekim Kuvveti (Fizik)</button>
        <button class="tab-btn" onclick="switchTab('tab3', this)">KÄ±rÄ±lma Deneyi</button>
    </div>

    <div id="tab1" class="tab-content active">
        <div class="card">
            <h2 style="text-align: center;">MÄ±knatÄ±s Ã‡eÅŸitleri</h2>
            <div class="gallery-grid">
                
                <div class="magnet-showcase">
                    <svg width="100" height="120" viewBox="0 0 100 120">
                        <path d="M 15 120 L 15 50 C 15 10 85 10 85 50 L 85 120 L 65 120 L 65 50 C 65 30 35 30 35 50 L 35 120 Z" fill="#bdc3c7" stroke="#2c3e50" stroke-width="2"/>
                        <path d="M 15 120 L 15 90 L 35 90 L 35 120 Z" fill="#ff3b30" stroke="none"/> <path d="M 85 120 L 85 90 L 65 90 L 65 120 Z" fill="#007aff" stroke="none"/> <text x="18" y="115" fill="white" font-size="14" font-weight="bold">N</text>
                        <text x="68" y="115" fill="white" font-size="14" font-weight="bold">S</text>
                    </svg>
                    <span class="label">At NalÄ± MÄ±knatÄ±s</span>
                </div>

                <div class="magnet-showcase">
                    <div style="width: 120px; height: 30px; display: flex; border-radius: 4px; overflow: hidden;">
                        <div style="width: 50%; background: var(--n-color); color: white; display:flex; align-items:center; justify-content:center; font-weight:bold;">N</div>
                        <div style="width: 50%; background: var(--s-color); color: white; display:flex; align-items:center; justify-content:center; font-weight:bold;">S</div>
                    </div>
                    <span class="label">Ã‡ubuk MÄ±knatÄ±s</span>
                </div>

                <div class="magnet-showcase">
                    <div style="width: 60px; height: 60px; border-radius: 50%; background: radial-gradient(circle at 30% 30%, #95a5a6, #2c3e50); box-shadow: 0 5px 10px rgba(0,0,0,0.3);"></div>
                    <span class="label">Yuvarlak MÄ±knatÄ±s</span>
                </div>
                
                <div class="magnet-showcase">
                     <div style="width: 60px; height: 60px; border-radius: 50%; background: #2c3e50; display:flex; align-items:center; justify-content:center; box-shadow: 0 5px 10px rgba(0,0,0,0.3);">
                        <div style="width: 25px; height: 25px; background: white; border-radius: 50%;"></div>
                     </div>
                    <span class="label">Halka MÄ±knatÄ±s</span>
                </div>

            </div>
        </div>
    </div>

    <div id="tab2" class="tab-content">
        <div class="card">
            <h2 style="text-align: center;">Deney MasasÄ±: Ä°tme ve Ã‡ekme</h2>
            <p style="text-align: center; font-size:0.9rem;">MÄ±knatÄ±sÄ± yaklaÅŸtÄ±rÄ±p bÄ±rakÄ±n. Fizik kurallarÄ± onu ya Ã§ekecek ya da itecek!</p>
            
            <div id="physics-zone">
                <div id="arrow-push" class="force-arrow" style="color: red; left: 45%; top: 40%;">â¬…ï¸ Ä°TÄ°YOR â¡ï¸</div>
                <div id="arrow-pull" class="force-arrow" style="color: green; left: 45%; top: 40%;">â¡ï¸ Ã‡EKÄ°YOR â¬…ï¸</div>

                <div class="magnet-obj" id="static-mag">
                    <div class="pole n">N</div>
                    <div class="pole s">S</div>
                </div>

                <div class="magnet-obj" id="dynamic-mag">
                    <div class="pole n">N</div>
                    <div class="pole s">S</div>
                </div>
            </div>

            <div class="controls">
                <button class="action-btn flip-btn" onclick="flipMagnet()">MÄ±knatÄ±sÄ± Ã‡evir ğŸ”„</button>
                <button class="action-btn" onclick="resetPhysics()">BaÅŸa DÃ¶n ğŸ”™</button>
            </div>
        </div>
    </div>

    <div id="tab3" class="tab-content">
        <div class="card">
            <h2 style="text-align: center;">MÄ±knatÄ±s BÃ¶lÃ¼nmesi</h2>
            <p style="text-align: center;">MÄ±knatÄ±s kÄ±rÄ±ldÄ±ÄŸÄ±nda kutuplar eÅŸit daÄŸÄ±lÄ±r. Her parÃ§a yeni bir mÄ±knatÄ±stÄ±r.</p>
            
            <div class="break-zone">
                <div id="whole-magnet" class="bar-magnet-large">
                    <div class="pole n" style="width: 50%;">N</div>
                    <div class="pole s" style="width: 50%;">S</div>
                </div>

                <div id="broken-magnets" class="broken-wrapper" style="display: none;">
                    <div class="half-magnet">
                        <div class="pole n" style="width: 50%;">N</div>
                        <div class="pole s" style="width: 50%;">S</div>
                    </div>
                    <div class="half-magnet">
                        <div class="pole n" style="width: 50%;">N</div>
                        <div class="pole s" style="width: 50%;">S</div>
                    </div>
                </div>

                <div class="controls">
                    <button class="action-btn" style="background: #e74c3c;" onclick="breakMagnet()">ğŸ”¨ MÄ±knatÄ±sÄ± KÄ±r</button>
                    <button class="action-btn" onclick="repairMagnet()">ğŸ§© BirleÅŸtir</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- SEKME GEÃ‡Ä°ÅLERÄ° ---
        function switchTab(tabId, btn) {
            document.querySelectorAll('.tab-content').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            btn.classList.add('active');
        }

        // --- FÄ°ZÄ°K MOTORU DEÄÄ°ÅKENLERÄ° ---
        const staticMag = document.getElementById('static-mag');
        const dynMag = document.getElementById('dynamic-mag');
        const zone = document.getElementById('physics-zone');
        const arrowPush = document.getElementById('arrow-push');
        const arrowPull = document.getElementById('arrow-pull');

        let isDragging = false;
        let isFlipped = false;
        let startX, startY, initLeft, initTop;
        let animationId;

        // --- OLAY DÄ°NLEYÄ°CÄ°LERÄ° ---
        dynMag.addEventListener('mousedown', startDrag);
        document.addEventListener('mousemove', drag);
        document.addEventListener('mouseup', endDrag);
        
        dynMag.addEventListener('touchstart', startDrag, {passive: false});
        document.addEventListener('touchmove', drag, {passive: false});
        document.addEventListener('touchend', endDrag);

        function startDrag(e) {
            isDragging = true;
            cancelAnimationFrame(animationId); // SÃ¼rÃ¼klerken fiziÄŸi durdur
            startX = e.clientX || e.touches[0].clientX;
            startY = e.clientY || e.touches[0].clientY;
            initLeft = dynMag.offsetLeft;
            initTop = dynMag.offsetTop;
            dynMag.style.transition = 'none'; // AnlÄ±k tepki iÃ§in animasyonu kapat
            dynMag.style.cursor = 'grabbing';
        }

        function drag(e) {
            if (!isDragging) return;
            e.preventDefault();
            const cx = e.clientX || e.touches[0].clientX;
            const cy = e.clientY || e.touches[0].clientY;
            
            let dx = cx - startX;
            let dy = cy - startY;
            
            let newLeft = initLeft + dx;
            let newTop = initTop + dy;

            // Alan dÄ±ÅŸÄ±na Ã§Ä±kmayÄ± engelle
            const maxX = zone.clientWidth - dynMag.offsetWidth;
            const maxY = zone.clientHeight - dynMag.offsetHeight;
            
            newLeft = Math.max(0, Math.min(newLeft, maxX));
            newTop = Math.max(0, Math.min(newTop, maxY));

            dynMag.style.left = newLeft + 'px';
            dynMag.style.top = newTop + 'px';
            
            showForceVisuals();
        }

        function endDrag() {
            isDragging = false;
            dynMag.style.cursor = 'grab';
            // SÃ¼rÃ¼kleme bitince fizik motorunu Ã§alÄ±ÅŸtÄ±r
            applyMagneticPhysics();
        }

        function flipMagnet() {
            isFlipped = !isFlipped;
            if (isFlipped) dynMag.classList.add('flipped');
            else dynMag.classList.remove('flipped');
            applyMagneticPhysics(); // Ã‡evirince hemen tepki ver
        }

        function showForceVisuals() {
            const sRect = staticMag.getBoundingClientRect();
            const dRect = dynMag.getBoundingClientRect();
            const dist = getDistance(sRect, dRect);

            arrowPush.style.opacity = 0;
            arrowPull.style.opacity = 0;

            if (dist < 250) {
                // Dinamik mÄ±knatÄ±sÄ±n SOL tarafÄ± hangi kutup?
                // Normalde N(sol)-S(saÄŸ). Ã‡evrilirse S(sol)-N(saÄŸ).
                // Sabit mÄ±knatÄ±sÄ±n SAÄ tarafÄ± S.
                
                const facingPole = isFlipped ? 'S' : 'N'; // Dinamik mÄ±knatÄ±sÄ±n sabit olana bakan ucu
                
                // Sabit ucu S (Mavi). Gelen uÃ§ N (KÄ±rmÄ±zÄ±) ise Ã‡EKER.
                if (facingPole === 'N') {
                    arrowPull.style.opacity = 1;
                    arrowPull.style.left = (dRect.left - zone.getBoundingClientRect().left - 50) + 'px';
                    arrowPull.style.top = (dRect.top - zone.getBoundingClientRect().top - 40) + 'px';
                } else {
                    arrowPush.style.opacity = 1;
                    arrowPush.style.left = (dRect.left - zone.getBoundingClientRect().left - 50) + 'px';
                    arrowPush.style.top = (dRect.top - zone.getBoundingClientRect().top - 40) + 'px';
                }
            }
        }

        // --- FÄ°ZÄ°K MOTORU (MAGÄ°C HAPPENS HERE) ---
        function applyMagneticPhysics() {
            const sRect = staticMag.getBoundingClientRect();
            
            function step() {
                if (isDragging) return;

                const dRect = dynMag.getBoundingClientRect();
                const dist = getDistance(sRect, dRect);
                const zoneRect = zone.getBoundingClientRect();

                // Mevcut konum (CSS'den sayÄ±ya Ã§evir)
                let currentLeft = parseFloat(dynMag.style.left) || 500;
                let currentTop = parseFloat(dynMag.style.top) || 195;

                // Manyetik Alan Menzili (piksel)
                const range = 250; 

                if (dist < range) {
                    const facingPole = isFlipped ? 'S' : 'N'; // Sabit olana bakan uÃ§
                    
                    // Hedef Y ekseni (Hizalanmak ister)
                    const targetY = staticMag.offsetTop; 
                    
                    if (facingPole === 'N') {
                        // --- Ã‡EKME KUVVETÄ° (ATTRACTION) ---
                        // Mavi (S) -> KÄ±rmÄ±zÄ± (N) : Ã‡eker
                        const targetX = staticMag.offsetLeft + staticMag.offsetWidth; // YapÄ±ÅŸma noktasÄ±
                        
                        // HÄ±z faktÃ¶rÃ¼ (YaklaÅŸtÄ±kÃ§a hÄ±zlanÄ±r)
                        const speed = (range - dist) / 10; 
                        
                        // Hedefe doÄŸru git
                        if (currentLeft > targetX) {
                            currentLeft -= speed;
                        }
                        
                        // Y ekseninde hizala
                        currentTop += (targetY - currentTop) * 0.1;

                        // YapÄ±ÅŸma KontrolÃ¼ (Snap)
                        if (currentLeft <= targetX + 5) {
                            currentLeft = targetX;
                            currentTop = targetY;
                            cancelAnimationFrame(animationId); // Durdur
                            showForceVisuals();
                            return; // DÃ¶ngÃ¼den Ã§Ä±k
                        }

                    } else {
                        // --- Ä°TME KUVVETÄ° (REPULSION) ---
                        // Mavi (S) -> Mavi (S) : Ä°ter
                        const pushForce = (300 - dist) / 15;
                        
                        // SaÄŸa doÄŸru it
                        currentLeft += pushForce;
                        
                        // EÄŸer Ã§ok yakÄ±nsa Y ekseninde de sapma yapar (GerÃ§ekÃ§ilik iÃ§in)
                        if (dist < 100) {
                            // Hafif yukarÄ± veya aÅŸaÄŸÄ± kayar
                            if(currentTop > targetY) currentTop += 2;
                            else currentTop -= 2;
                        }

                        // Sahne dÄ±ÅŸÄ±na Ã§Ä±kma kontrolÃ¼
                        if (currentLeft > zone.clientWidth - dynMag.offsetWidth) {
                            currentLeft = zone.clientWidth - dynMag.offsetWidth;
                            cancelAnimationFrame(animationId);
                            return;
                        }
                    }

                    // Yeni koordinatlarÄ± uygula
                    dynMag.style.left = currentLeft + 'px';
                    dynMag.style.top = currentTop + 'px';
                    
                    showForceVisuals();
                    animationId = requestAnimationFrame(step);
                } else {
                    arrowPull.style.opacity = 0;
                    arrowPush.style.opacity = 0;
                }
            }
            animationId = requestAnimationFrame(step);
        }

        function getDistance(r1, r2) {
            // Merkezler arasÄ± mesafe
            const x1 = r1.left + r1.width/2;
            const y1 = r1.top + r1.height/2;
            const x2 = r2.left + r2.width/2;
            const y2 = r2.top + r2.height/2;
            return Math.sqrt(Math.pow(x2-x1, 2) + Math.pow(y2-y1, 2));
        }

        function resetPhysics() {
            dynMag.style.transition = 'all 0.5s ease';
            dynMag.style.left = '500px';
            dynMag.style.top = '195px';
            isFlipped = false;
            dynMag.classList.remove('flipped');
            setTimeout(() => {
                dynMag.style.transition = 'none';
            }, 500);
            arrowPull.style.opacity = 0;
            arrowPush.style.opacity = 0;
        }

        // --- KIRILMA FONKSÄ°YONLARI ---
        function breakMagnet() {
            document.getElementById('whole-magnet').style.display = 'none';
            document.getElementById('broken-magnets').style.display = 'flex';
        }

        function repairMagnet() {
            document.getElementById('whole-magnet').style.display = 'flex';
            document.getElementById('broken-magnets').style.display = 'none';
        }

        // BaÅŸlangÄ±Ã§ta fiziÄŸi bir kere kontrol et
        resetPhysics();

    </script>
</body>
</html>
