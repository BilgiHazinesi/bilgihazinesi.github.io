<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DÃ¼nya Hareketleri ve GÃ¶lge - GeliÅŸmiÅŸ Versiyon</title>
    <style>
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background-color: #050510; color: white; overflow-x: hidden; }
        
        /* BaÅŸlÄ±k AlanÄ± */
        header {
            background: linear-gradient(90deg, #0f2027, #203a43, #2c5364);
            padding: 10px; text-align: center; border-bottom: 2px solid #ffd700;
        }
        h1 { margin: 0; color: #ffd700; font-size: 1.4rem; }
        p { margin: 5px; font-size: 0.9rem; color: #ccc; }

        /* -------------------------
           BÃ–LÃœM 1: 3D SAHNE
           ------------------------- */
        #canvas-container {
            width: 100%; height: 50vh; position: relative; background: black; overflow: hidden;
        }
        .controls-3d {
            position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%);
        }
        button {
            background: #ff512f; color: white; border: none; padding: 8px 20px; 
            border-radius: 20px; cursor: pointer; font-weight: bold;
            box-shadow: 0 0 10px #ff512f;
        }
        button:hover { background: #dd2476; }

        /* Etiketler */
        .label {
            position: absolute; color: white; background: rgba(0,0,0,0.7);
            padding: 3px 8px; border-radius: 4px; font-size: 0.8rem; pointer-events: none;
        }
        .season-label { color: #ffd700; border: 1px solid #ffd700; font-weight: bold; }

        /* -------------------------
           BÃ–LÃœM 2: GÃ–LGE LABI
           ------------------------- */
        .shadow-lab {
            background-color: #eef2f3; color: #333; padding: 20px;
            display: flex; flex-direction: column; align-items: center;
            border-top: 5px solid #333;
        }

        .lab-container {
            display: flex; flex-wrap: wrap; justify-content: center; gap: 40px; width: 100%; max-width: 1100px;
        }

        .view-box {
            display: flex; flex-direction: column; align-items: center;
        }
        .view-title { margin-bottom: 10px; font-weight: bold; color: #2c3e50; }

        /* SOL: KuÅŸbakÄ±ÅŸÄ± DÃ¼nya (Top View) */
        .top-scene {
            width: 250px; height: 250px; position: relative;
            background: #1a1a2e; border-radius: 10px; border: 2px solid #555;
            display: flex; align-items: center; justify-content: center;
        }
        
        /* CSS DÃ¼nya */
        .earth-css {
            width: 120px; height: 120px;
            background: radial-gradient(circle at 30% 30%, #4facfe, #00f2fe);
            border-radius: 50%;
            position: relative;
            box-shadow: inset -10px -10px 20px rgba(0,0,0,0.5); /* Gece tarafÄ± gÃ¶lgesi */
            /* DÃ¶nÃ¼ÅŸ JS ile verilecek */
        }
        
        /* Minik Ä°nsan (KuÅŸbakÄ±ÅŸÄ± Kafa) */
        .tiny-human {
            width: 8px; height: 8px; background: red; border-radius: 50%;
            position: absolute; top: -4px; left: 56px; /* Tam tepe noktasÄ± */
            z-index: 2;
        }
        
        /* Minik Ä°nsanÄ±n GÃ¶lgesi (DÃ¼nya Ã¼zerine dÃ¼ÅŸen) */
        .tiny-shadow {
            position: absolute;
            top: 0px; left: 58px; /* Ä°nsanÄ±n dibinden baÅŸlar */
            height: 4px; width: 0px; /* Uzunluk JS ile deÄŸiÅŸecek */
            background: rgba(0,0,0,0.6);
            transform-origin: left center;
            border-radius: 2px;
            z-index: 1;
        }

        /* Sabit GÃ¼neÅŸ (KuÅŸbakÄ±ÅŸÄ± iÃ§in referans) */
        .sun-ref {
            position: absolute; right: 10px; top: 50%; transform: translateY(-50%);
            font-size: 2rem;
        }

        /* SAÄ: Yer GÃ¶rÃ¼nÃ¼mÃ¼ (Ground View) */
        .ground-scene {
            width: 450px; height: 250px; position: relative;
            background: #87CEEB; /* GÃ¶kyÃ¼zÃ¼ */
            border: 4px solid #333; border-radius: 10px; overflow: hidden;
        }

        /* Hareketli GÃ¼neÅŸ */
        .moving-sun {
            width: 50px; height: 50px;
            background: radial-gradient(circle, #ffd700 40%, orange 100%);
            border-radius: 50%;
            position: absolute;
            bottom: -60px; left: -60px; /* BaÅŸlangÄ±Ã§ta gizli */
            box-shadow: 0 0 30px #ffd700;
        }

        /* Yer, Adam ve GÃ¶lge */
        .ground { position: absolute; bottom: 0; width: 100%; height: 40px; background: #4caf50; z-index: 10; }
        .stick-figure {
            position: absolute; bottom: 40px; left: 50%; width: 10px; height: 60px; 
            background: #222; transform: translateX(-50%); z-index: 5;
        }
        .stick-head {
            position: absolute; top: -20px; left: -5px; width: 20px; height: 20px; 
            background: #222; border-radius: 50%;
        }
        .ground-shadow {
            position: absolute; bottom: 40px; left: 50%; height: 6px; background: rgba(0,0,0,0.5);
            width: 0; transform-origin: left center; border-radius: 10px;
        }

        /* Pusula */
        .compass {
            position: absolute; bottom: 5px; width: 100%; display: flex; justify-content: space-between;
            padding: 0 20px; box-sizing: border-box; font-weight: bold; color: white; font-size: 0.8rem;
        }

        /* Slider AlanÄ± */
        .control-panel {
            width: 80%; margin-top: 20px; text-align: center; background: white; padding: 15px;
            border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        input[type=range] { width: 100%; cursor: pointer; }
        #timeDisplay { font-size: 1.2rem; font-weight: bold; color: #d35400; }

    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
</head>
<body>

<header>
    <h1>ğŸŒ DÃ¼nya'nÄ±n GerÃ§ek Hareketleri & GÃ¶lge</h1>
    <p>Mevsimler, Eksen EÄŸikliÄŸi ve GÃ¼nlÃ¼k Hareket</p>
</header>

<div id="canvas-container">
    <div class="controls-3d">
        <button onclick="toggleOrbit()">YÃ¶rÃ¼nge Hareketini Durdur/BaÅŸlat</button>
    </div>
</div>

<div class="shadow-lab">
    <div class="control-panel">
        <div id="timeDisplay">Saat: 06:00 (GÃ¼ndoÄŸumu)</div>
        <input type="range" id="daySlider" min="0" max="360" value="90" oninput="updateDayCycle()">
        <p>Ã‡ubuÄŸu kaydÄ±rarak zamanÄ± ilerletin (GÃ¼neÅŸ DoÄŸudan BatÄ±ya gider, sonra gece olur)</p>
    </div>

    <div class="lab-container">
        <div class="view-box">
            <div class="view-title">1. Uzaydan BakÄ±ÅŸ (Kuzey Kutbu)</div>
            <div class="top-scene">
                <div class="sun-ref">â˜€ï¸</div>
                <div class="earth-css" id="earthTop">
                    <div class="tiny-human"></div>
                    <div class="tiny-shadow" id="topShadow"></div>
                </div>
                <div style="position:absolute; bottom: 5px; color: #aaa; font-size: 0.8rem;">DÃ¼nya saat yÃ¶nÃ¼nÃ¼n tersine dÃ¶ner â†º</div>
            </div>
            <p style="font-size:0.8rem; max-width:250px; text-align:center;">
                DÃ¼nya dÃ¶nerken gÃ¶lge her zaman GÃ¼neÅŸ'in tersi yÃ¶nÃ¼ne (GÃ¼neÅŸ saÄŸdaysa sola) dÃ¼ÅŸer.
            </p>
        </div>

        <div class="view-box">
            <div class="view-title">2. Yerden BakÄ±ÅŸ (Bizim GÃ¶zÃ¼mÃ¼zden)</div>
            <div class="ground-scene" id="sky">
                <div class="moving-sun" id="sunMove"></div>
                
                <div class="stick-figure"><div class="stick-head"></div></div>
                <div class="ground-shadow" id="groundShadow"></div>

                <div class="ground">
                    <div class="compass">
                        <span>â¬…ï¸ BATI</span>
                        <span>DOÄU â¡ï¸</span>
                    </div>
                </div>
                <div id="nightText" style="position:absolute; top:40%; width:100%; text-align:center; font-size:2rem; color:white; opacity:0;">ğŸŒ‘ GECE</div>
            </div>
        </div>
    </div>
</div>

<script>
    // ==========================================
    // BÃ–LÃœM 1: 3D SAHNE (DOÄRU EKSEN EÄÄ°KLÄ°ÄÄ°)
    // ==========================================
    const container = document.getElementById('canvas-container');
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(45, container.clientWidth / container.clientHeight, 0.1, 1000);
    camera.position.set(0, 40, 60); // KamerayÄ± biraz yukarÄ± aldÄ±m
    camera.lookAt(0, 0, 0);

    const renderer = new THREE.WebGLRenderer({ antialias: true });
    renderer.setSize(container.clientWidth, container.clientHeight);
    container.appendChild(renderer.domElement);

    const controls = new THREE.OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    // IÅŸÄ±klar
    scene.add(new THREE.AmbientLight(0x333333));
    const sunLight = new THREE.PointLight(0xffffff, 2, 150);
    scene.add(sunLight);

    // 1. GÃ¼neÅŸ
    const sun = new THREE.Mesh(
        new THREE.SphereGeometry(4, 32, 32),
        new THREE.MeshBasicMaterial({ color: 0xffd700 })
    );
    scene.add(sun);

    // 2. YÃ¶rÃ¼nge Ã‡izgisi (Elips)
    const curve = new THREE.EllipseCurve(0, 0, 30, 20, 0, 2 * Math.PI, false, 0);
    const points = curve.getPoints(100);
    const orbitLine = new THREE.Line(
        new THREE.BufferGeometry().setFromPoints(points),
        new THREE.LineBasicMaterial({ color: 0xffffff, opacity: 0.2, transparent: true })
    );
    orbitLine.rotation.x = Math.PI / 2;
    scene.add(orbitLine);

    // 3. DÃœNYA GRUBU (YÃ¶rÃ¼ngede dÃ¶nen ana taÅŸÄ±yÄ±cÄ±)
    const earthOrbitGroup = new THREE.Group();
    scene.add(earthOrbitGroup);

    // 4. EKSEN EÄÄ°KLÄ°ÄÄ° KONTEYNERÄ° (TILT GROUP)
    // Ä°ÅŸte pÃ¼f noktasÄ±: DÃ¼nya'yÄ± direkt dÃ¶ndÃ¼rmÃ¼yoruz.
    // Bu kutuyu 23.5 derece eÄŸiyoruz. Ä°Ã§indeki DÃ¼nya normal dÃ¶nÃ¼yor.
    const earthTiltContainer = new THREE.Group();
    // DÃ¼nya'yÄ± yÃ¶rÃ¼nge grubunun iÃ§ine deÄŸil, pozisyonlandÄ±rdÄ±ktan sonra sahneye ekleyeceÄŸiz
    // Ancak basitlik iÃ§in burada her frame'de pozisyon gÃ¼ncelleyeceÄŸiz.
    scene.add(earthTiltContainer);

    // 5. DÃ¼nya Mesh'i
    const earth = new THREE.Mesh(
        new THREE.SphereGeometry(1.5, 32, 32),
        new THREE.MeshPhongMaterial({ color: 0x2233ff, emissive: 0x112244, specular: 0x111111, shininess: 15 })
    );
    
    // Eksen Ã‡ubuÄŸu (GÃ¶rselleÅŸtirmek iÃ§in)
    const axisLine = new THREE.Mesh(
        new THREE.CylinderGeometry(0.05, 0.05, 5, 8),
        new THREE.MeshBasicMaterial({ color: 0xff0000 })
    );
    
    // DÃ¼nya ve Ã‡ubuÄŸu EÄŸik Konteynera ekle
    earthTiltContainer.add(earth);
    earthTiltContainer.add(axisLine);

    // KonteynerÄ± 23.5 Derece EÄÄ°YORUZ (Z ekseninde)
    earthTiltContainer.rotation.z = 23.5 * (Math.PI / 180);

    // Etiket OluÅŸturucu
    function createLabel(text, x, z, isSeason) {
        const div = document.createElement('div');
        div.className = isSeason ? 'label season-label' : 'label';
        div.textContent = text;
        container.appendChild(div);
        return { element: div, pos: new THREE.Vector3(x, 0, z) };
    }
    const labels = [
        createLabel("21 Haziran (Yaz)", 30, 0, true),
        createLabel("21 AralÄ±k (KÄ±ÅŸ)", -30, 0, true),
        createLabel("23 EylÃ¼l (Sonbahar)", 0, 20, true),
        createLabel("21 Mart (Ä°lkbahar)", 0, -20, true)
    ];

    let orbitAngle = 0;
    let isRunning = true;

    function animate() {
        requestAnimationFrame(animate);

        if (isRunning) {
            // YÃ¶rÃ¼nge Hareketi
            orbitAngle += 0.005;
            if(orbitAngle > Math.PI * 2) orbitAngle = 0;
        }

        // DÃ¼nyanÄ±n Konumunu Hesapla (Elips)
        const x = 30 * Math.cos(orbitAngle);
        const z = 20 * Math.sin(orbitAngle);
        
        // EÄŸik KonteynerÄ± taÅŸÄ±
        earthTiltContainer.position.set(x, 0, z);

        // DÃœNYA KENDÄ° EKSENÄ°NDE DÃ–NÃœYOR
        // Sadece Y eksenini dÃ¶ndÃ¼rÃ¼yoruz. Konteyner eÄŸik olduÄŸu iÃ§in
        // DÃ¼nya da eÄŸik ekseni etrafÄ±nda dÃ¶nÃ¼yor!
        earth.rotation.y += 0.03; 

        controls.update();
        renderer.render(scene, camera);

        // Etiketleri gÃ¼ncelle
        labels.forEach(lbl => {
            const v = lbl.pos.clone();
            v.project(camera);
            const lx = (v.x * .5 + .5) * container.clientWidth;
            const ly = (-(v.y * .5) + .5) * container.clientHeight;
            lbl.element.style.transform = `translate(-50%, -50%) translate(${lx}px, ${ly}px)`;
        });
    }
    animate();
    function toggleOrbit() { isRunning = !isRunning; }
    window.addEventListener('resize', () => {
        camera.aspect = container.clientWidth / container.clientHeight;
        camera.updateProjectionMatrix();
        renderer.setSize(container.clientWidth, container.clientHeight);
    });


    // ==========================================
    // BÃ–LÃœM 2: GELÄ°ÅMÄ°Å GÃ–LGE SÄ°MÃœLASYONU
    // ==========================================
    
    function updateDayCycle() {
        const val = parseInt(document.getElementById('daySlider').value);
        // Slider 0 - 360 derece.
        // 0: Gece YarÄ±sÄ±
        // 90: Sabah 06:00 (DoÄŸudan DoÄŸuÅŸ)
        // 180: Ã–ÄŸle 12:00 (Tepe)
        // 270: AkÅŸam 18:00 (BatÄ±dan BatÄ±ÅŸ)
        // 360: Gece YarÄ±sÄ±
        
        // Saat GÃ¶stergesi
        const hours = Math.floor((val / 360) * 24);
        const mins = Math.floor(((val / 360) * 24 * 60) % 60);
        document.getElementById('timeDisplay').innerText = 
            `Saat: ${hours.toString().padStart(2,'0')}:${mins.toString().padStart(2,'0')}`;

        // --- KISIM A: YER GÃ–RÃœNÃœMÃœ (GÃ¼neÅŸ DoÄŸudan BatÄ±ya) ---
        const sunElem = document.getElementById('sunMove');
        const skyElem = document.getElementById('sky');
        const groundShadow = document.getElementById('groundShadow');
        const nightText = document.getElementById('nightText');

        // GÃ¼neÅŸin Pozisyonu (Yerden BakÄ±ÅŸ)
        // GÃ¼neÅŸ DoÄŸudan (SaÄŸdan) doÄŸar -> EkranÄ±n %100'Ã¼ (SaÄŸ)
        // BatÄ±dan (Soldan) batar -> EkranÄ±n %0'Ä± (Sol)
        // 90 derecede SaÄŸda baÅŸlamalÄ±, 270 derecede Solda bitmeli.
        
        if (val >= 80 && val <= 280) {
            // GÃœNDÃœZ
            skyElem.style.backgroundColor = "#87CEEB"; // Mavi
            nightText.style.opacity = 0;
            sunElem.style.opacity = 1;
            groundShadow.style.opacity = 1;

            // GÃ¼neÅŸ Hareketi Hesaplama
            // 80 (Sabah) -> Left %90 (DoÄŸu/SaÄŸ)
            // 180 (Ã–ÄŸle) -> Left %50 (Tepe)
            // 280 (AkÅŸam) -> Left %10 (BatÄ±/Sol)
            
            // Normalizasyon: (val - 80) / 200 => 0 ile 1 arasÄ±
            const progress = (val - 80) / 200; 
            
            // X Pozisyonu: SaÄŸdan Sola gitmeli. Yani %90'dan %10'a.
            // left = 90% - (progress * 80%)
            const sunLeft = 90 - (progress * 80);
            
            // Y Pozisyonu: Yay Ã§izmeli (SinÃ¼s)
            const sunBottom = Math.sin(progress * Math.PI) * 180 + 20; 

            sunElem.style.left = `${sunLeft}%`;
            sunElem.style.bottom = `${sunBottom}px`;

            // GÃ¶lge Hesaplama (Yer)
            // GÃ¼neÅŸ SaÄŸdaysa (BÃ¼yÃ¼k left deÄŸeri), GÃ¶lge Sola dÃ¼ÅŸer.
            const distFromCenter = val - 180; // -100 (Sabah) ile +100 (AkÅŸam)
            
            // Sabah (dist negatif): GÃ¼neÅŸ doÄŸuda, gÃ¶lge BATIA (Sola).
            // AkÅŸam (dist pozitif): GÃ¼neÅŸ batÄ±da, gÃ¶lge DOÄUYA (SaÄŸa).
            
            // GÃ¶lge uzunluÄŸu merkezden uzaklaÅŸtÄ±kÃ§a artar.
            let sLen = distFromCenter * 1.5;
            
            if (sLen < 0) { // Sabah -> GÃ¶lge Sola
                groundShadow.style.width = `${Math.abs(sLen)}px`;
                groundShadow.style.transform = "translateX(-100%)"; 
            } else { // AkÅŸam -> GÃ¶lge SaÄŸa
                groundShadow.style.width = `${sLen}px`;
                groundShadow.style.transform = "translateX(0)";
            }
            
        } else {
            // GECE
            skyElem.style.backgroundColor = "#0f172a"; // Lacivert
            nightText.style.opacity = 1;
            sunElem.style.opacity = 0; // GÃ¼neÅŸ gÃ¶rÃ¼nmez
            groundShadow.style.opacity = 0; // GÃ¶lge yok
        }

        // --- KISIM B: UZAY GÃ–RÃœNÃœMÃœ (DÃ¼nya DÃ¶ner, GÃ¶lge Ãœzerine DÃ¼ÅŸer) ---
        const earthCss = document.getElementById('earthTop');
        const topShadow = document.getElementById('topShadow');

        // DÃ¼nya saat yÃ¶nÃ¼nÃ¼n tersine dÃ¶ner.
        // Saat 0 -> 0 derece.
        // Saat 12 -> 180 derece.
        earthCss.style.transform = `rotate(${-val}deg)`; 

        // GÃ–LGE MANTIÄI (Top View)
        // GÃ¼neÅŸ SAÄDA sabit. IÅŸÄ±k SaÄŸdan geliyor.
        // GÃ¶lge her zaman cismin SOLUNA dÃ¼ÅŸmeli (Global olarak).
        // Ama cisim (DÃ¼nya ve Ä°nsan) dÃ¶nÃ¼yor!
        // Ä°nsan dÃ¶ndÃ¼kÃ§e, gÃ¶lgenin "div"i de onunla dÃ¶ner.
        // GÃ¶lgenin her zaman Sola bakmasÄ± iÃ§in, DÃ¼nya'nÄ±n dÃ¶nÃ¼ÅŸÃ¼nÃ¼n TERSÄ°NE dÃ¶nmesi gerekir.
        // Yani: shadowRotation = -earthRotation.
        
        // Sadece GÃ¼ndÃ¼z Saatlerinde (GÃ¼neÅŸi gÃ¶rÃ¼yor) gÃ¶lge var.
        // Ä°nsan DÃ¼nya'nÄ±n tepesinde (baÅŸlangÄ±Ã§ 0 derece).
        // GÃ¼neÅŸ SaÄŸda (90 derece yÃ¶nÃ¼nde).
        // 90 derece (Sabah) -> Ä°nsan gÃ¼neÅŸe bakar.
        // 270 derece (AkÅŸam) -> Ä°nsan gÃ¼neÅŸten kaÃ§ar.
        
        if (val >= 80 && val <= 280) {
            topShadow.style.opacity = 1;
            
            // GÃ¶lge her zaman Sola (BatÄ±ya) bakmalÄ± Ã§Ã¼nkÃ¼ GÃ¼neÅŸ SaÄŸda (DoÄŸuda).
            // Global aÃ§Ä±sÄ± 180 (Sol) olmalÄ±.
            // Parent (DÃ¼nya) aÃ§Ä±sÄ±: -val
            // Child (GÃ¶lge) aÃ§Ä±sÄ± ne olmalÄ± ki toplamÄ± 180 olsun?
            // ChildAngle + (-val) = 180 => ChildAngle = 180 + val
            
            // DÃ¼zeltme: GÃ¼neÅŸ tam saÄŸda (ekranÄ±n saÄŸÄ±).
            // IÅŸÄ±k vektÃ¶rÃ¼: <--- (Sola doÄŸru).
            // GÃ¶lge vektÃ¶rÃ¼: <--- (Sola doÄŸru).
            // GÃ¶lge her zaman ekranda SOLA (Left) bakmalÄ±.
            // CSS'de rotate(0) saÄŸa bakar. rotate(180) sola bakar.
            // Hedef rotasyon: 180 derece (global).
            // Mevcut rotasyon (parent): -val.
            // Gerekli local rotasyon: val + 180.
            
            topShadow.style.transform = `rotate(${val + 180}deg)`;
            
            // GÃ¶lge Boyu (Top View)
            // GÃ¼neÅŸ tam tepedeyken (insan gÃ¼neÅŸin hizasÄ±ndayken) gÃ¶lge uzun.
            // Ä°nsan merkeze geldiÄŸinde (Ã¶ÄŸle) gÃ¶lge kÄ±sa? HayÄ±r, bu kuÅŸbakÄ±ÅŸÄ±.
            // KuÅŸbakÄ±ÅŸÄ±nda gÃ¶lge boyu, insanÄ±n dÃ¼nya Ã¼zerindeki eÄŸimine baÄŸlÄ±dÄ±r.
            // Basit modelleme iÃ§in:
            // Ã–ÄŸle vakti (180) -> Ä°nsan gÃ¼neÅŸe dik (En yakÄ±n) -> GÃ¶lge insanÄ±n arkasÄ±na dÃ¼ÅŸer.
            // Ama 2D dÃ¼zlemde bunu "boyu kÄ±salÄ±r" olarak gÃ¶sterelim.
            
            let dist = Math.abs(val - 180); // 0 (Ã–ÄŸle) -> 90 (Ufuk)
            let shadowLenTop = (dist / 90) * 40; // Kenarlarda uzun, ortada kÄ±sa
            
            topShadow.style.width = `${shadowLenTop}px`;
            
        } else {
            topShadow.style.opacity = 0; // Gece gÃ¶lge yok
        }
    }
    
    // BaÅŸlangÄ±Ã§
    updateDayCycle();

</script>
</body>
</html>
