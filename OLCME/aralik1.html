<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mobil Uyumlu Deƒüerlendirme</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');

        /* --- GENEL MOBƒ∞L AYARLARI --- */
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f0f2f5;
            margin: 0;
            padding: 0;
            color: #333;
            -webkit-tap-highlight-color: transparent; /* Mobilde tƒ±klama efektini d√ºzeltir */
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
            padding-bottom: 80px; /* Alt buton i√ßin bo≈üluk */
        }

        /* --- KART YAPISI --- */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            padding: 15px;
            margin-bottom: 15px;
        }

        h2, h3 { margin: 0 0 10px 0; color: #2c3e50; }
        
        /* --- Gƒ∞Rƒ∞≈û ALANLARI --- */
        input[type="text"], textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px; /* 16px mobilde zoom yapmayƒ± engeller */
            box-sizing: border-box;
            font-family: inherit;
        }

        input[type="text"]:focus { border-color: #3498db; outline: none; }

        /* --- BUTONLAR --- */
        .btn {
            width: 100%;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 15px;
            cursor: pointer;
            margin-top: 5px;
            color: white;
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.98); }
        .btn-blue { background-color: #3498db; }
        .btn-green { background-color: #27ae60; }
        .btn-orange { background-color: #e67e22; }
        
        /* Hƒ±zlƒ± Doldur Butonlarƒ± */
        .quick-fill-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            background: #eef2f3;
            padding: 8px;
            border-radius: 8px;
            align-items: center;
        }
        .btn-quick {
            background: #2c3e50;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 13px;
        }

        /* --- SORU SATIRLARI (MOBƒ∞L DOSTU) --- */
        .question-row {
            border-bottom: 1px solid #eee;
            padding: 12px 0;
        }
        .question-text {
            font-size: 14px;
            margin-bottom: 8px;
            font-weight: 500;
            display: block;
        }
        .options-grid {
            display: flex;
            gap: 5px;
        }
        
        /* B√ºy√ºk Dokunmatik Se√ßenekler */
        .option-btn {
            flex: 1;
            padding: 10px;
            text-align: center;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-weight: bold;
            color: #7f8c8d;
            background: white;
            transition: all 0.2s;
        }

        /* Se√ßili Durumlar */
        .selected-2 { background-color: #27ae60; color: white; border-color: #27ae60; } /* Tam */
        .selected-1 { background-color: #f1c40f; color: white; border-color: #f1c40f; text-shadow: 0 1px 1px rgba(0,0,0,0.2); } /* Kƒ±smen */
        .selected-0 { background-color: #e74c3c; color: white; border-color: #e74c3c; } /* Yok */

        /* --- ALT SABƒ∞T MEN√ú (PDF BUTONU) --- */
        .bottom-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: white;
            padding: 10px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            display: flex;
            gap: 10px;
            z-index: 100;
            box-sizing: border-box;
        }

        /* --- Gƒ∞ZLƒ∞ BASKI ALANI --- */
        #print-area { display: none; }

        @media print {
            body * { visibility: hidden; }
            .container, .bottom-bar { display: none; }
            #print-area, #print-area * { 
                visibility: visible; 
                display: block;
            }
            #print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
            }
            
            .print-page {
                page-break-after: always;
                padding: 30px 40px;
                font-family: 'Times New Roman', serif;
            }
            .print-header { text-align: center; border-bottom: 2px solid black; margin-bottom: 20px; }
            .print-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 12pt; }
            .print-table th, .print-table td { border: 1px solid #333; padding: 6px; }
            .print-check { font-size: 18px; text-align: center; font-weight: bold; }
        }
    </style>
</head>
<body>

    <div class="container">
        <div class="card" id="setupCard">
            <h3>üìÇ Sƒ±nƒ±f Listesi</h3>
            <textarea id="rawList" rows="3" placeholder="Listeyi buraya yapƒ±≈ütƒ±r..."></textarea>
            <button class="btn btn-blue" onclick="loadList()">Listeyi Y√ºkle ve Ba≈üla</button>
        </div>

        <div class="card sticky-top" style="position:sticky; top:10px; z-index:90;">
            <label style="font-size:12px; color:#666;">√ñƒürenci Ara:</label>
            <input list="students-dl" id="studentSearch" type="text" placeholder="ƒ∞sim yaz..." oninput="selectStudent(this.value)">
            <datalist id="students-dl"></datalist>
            <div id="status" style="font-size:13px; margin-top:5px; color:#27ae60; font-weight:bold; height:18px;"></div>
        </div>

        <div id="rubricArea" style="display:none;">
            
            <div class="card">
                <div class="quick-fill-bar">
                    <h3 style="margin:0; color:#d35400;">T√ºrk√ße</h3>
                    <button class="btn-quick" onclick="quickFill('t', 2)">T√ºm√ºn√º Tam Yap</button>
                </div>
                <div id="turkish-questions"></div>
            </div>

            <div class="card">
                <div class="quick-fill-bar">
                    <h3 style="margin:0; color:#2980b9;">Matematik</h3>
                    <button class="btn-quick" onclick="quickFill('m', 2)">T√ºm√ºn√º Tam Yap</button>
                </div>
                <div id="math-questions"></div>
            </div>

            <div class="card">
                <h3>üìù √ñƒüretmen G√∂r√º≈ü√º</h3>
                <textarea id="commentBox" rows="3" oninput="saveComment()" placeholder="Eksikler veya √∂dev √∂nerisi..."></textarea>
            </div>
        </div>
    </div>

    <div class="bottom-bar">
        <button class="btn btn-orange" onclick="generatePDF()">üñ®Ô∏è PDF ƒ∞NDƒ∞R</button>
    </div>

    <div id="print-area"></div>

    <script>
        // --- VERƒ∞LER ---
        const turkishQ = [
            { id: 't1', code: '1. Soru', text: '≈ûiir analizi, ana duygu ve kronoloji' },
            { id: 't2', code: '2. Soru', text: 'Neden-sonu√ß, soru ve kar≈üƒ±la≈ütƒ±rma c√ºmleleri' },
            { id: 't3', code: '3. Soru', text: 'Metin t√ºr√º (Hikaye edici)' },
            { id: 't4', code: '4. Soru', text: 'E≈ü sesli kelimeler' },
            { id: 't5', code: '5. Soru', text: 'E≈ü anlam ve Zƒ±t anlam' }
        ];

        const mathQ = [
            { id: 'm1', code: '1. Soru', text: 'Yuvarlama ve sƒ±ralama (<, >)' },
            { id: 'm2', code: '2. Soru', text: 'Sƒ±ralama ve √∂r√ºnt√º' },
            { id: 'm3', code: '3. Soru', text: 'Toplama problemleri' },
            { id: 'm4', code: '4. Soru', text: 'D√∂rt i≈ülem becerisi' },
            { id: 'm5', code: '5. Soru', text: 'Basamak analizi' },
            { id: 'm6', code: '6. Soru', text: 'Sayƒ± √∂r√ºnt√ºs√º kuralƒ±' },
            { id: 'm7', code: '7. Soru', text: '√áƒ±karma problemleri' },
            { id: 'm8', code: '8. Soru', text: 'Mantƒ±k muhakeme' }
        ];

        let studentsData = {};
        let currentStudent = null;

        // --- SAYFA Y√úKLENƒ∞NCE SORULARI OLU≈ûTUR ---
        function renderQuestions() {
            const createHTML = (q) => `
                <div class="question-row" id="row-${q.id}">
                    <span class="question-text"><b>${q.code}:</b> ${q.text}</span>
                    <div class="options-grid">
                        <div class="option-btn" onclick="mark('${q.id}', 2)" id="btn-${q.id}-2">Tam</div>
                        <div class="option-btn" onclick="mark('${q.id}', 1)" id="btn-${q.id}-1">Kƒ±smen</div>
                        <div class="option-btn" onclick="mark('${q.id}', 0)" id="btn-${q.id}-0">Eksik</div>
                    </div>
                </div>
            `;
            document.getElementById('turkish-questions').innerHTML = turkishQ.map(createHTML).join('');
            document.getElementById('math-questions').innerHTML = mathQ.map(createHTML).join('');
        }
        renderQuestions();

        // --- Lƒ∞STE Y√ñNETƒ∞Mƒ∞ ---
        function loadList() {
            const raw = document.getElementById('rawList').value;
            const names = raw.split('\n').filter(n => n.trim().length > 1);
            
            const dl = document.getElementById('students-dl');
            dl.innerHTML = '';
            studentsData = {};

            names.forEach(name => {
                studentsData[name.trim()] = { scores: {}, comment: '' };
                const opt = document.createElement('option');
                opt.value = name.trim();
                dl.appendChild(opt);
            });

            document.getElementById('setupCard').style.display = 'none'; // Alan kazanmak i√ßin gizle
            alert(names.length + " √ñƒürenci Y√ºklendi. Aramaya ba≈ülayƒ±n.");
        }

        // --- √ñƒûRENCƒ∞ SE√áƒ∞Mƒ∞ ---
        function selectStudent(name) {
            if (studentsData[name]) {
                currentStudent = name;
                document.getElementById('rubricArea').style.display = 'block';
                document.getElementById('status').innerText = "Se√ßili: " + name;
                
                // Formu doldur
                const data = studentsData[name];
                document.getElementById('commentBox').value = data.comment;
                
                // G√∂rseli yenile
                updateUI(data.scores);
            }
        }

        // --- PUANLAMA MANTIƒûI ---
        function mark(qId, val) {
            if (!currentStudent) return;
            studentsData[currentStudent].scores[qId] = val;
            updateUI(studentsData[currentStudent].scores);
        }

        function quickFill(prefix, val) {
            if (!currentStudent) return;
            const questions = prefix === 't' ? turkishQ : mathQ;
            questions.forEach(q => {
                studentsData[currentStudent].scores[q.id] = val;
            });
            updateUI(studentsData[currentStudent].scores);
        }

        function updateUI(scores) {
            // T√ºm butonlarƒ± sƒ±fƒ±rla
            document.querySelectorAll('.option-btn').forEach(b => {
                b.classList.remove('selected-2', 'selected-1', 'selected-0');
            });

            // Se√ßilileri boya
            for (const [qId, val] of Object.entries(scores)) {
                const btn = document.getElementById(`btn-${qId}-${val}`);
                if (btn) btn.classList.add(`selected-${val}`);
            }
        }

        function saveComment() {
            if(currentStudent) {
                studentsData[currentStudent].comment = document.getElementById('commentBox').value;
            }
        }

        // --- PDF OLU≈ûTURMA ---
        function generatePDF() {
            const printDiv = document.getElementById('print-area');
            printDiv.innerHTML = '';

            const students = Object.keys(studentsData);
            if(students.length === 0) { alert("Liste bo≈ü!"); return; }

            const today = new Date().toLocaleDateString('tr-TR');

            students.forEach(name => {
                const data = studentsData[name];
                // Eƒüer hi√ß puan girilmediyse (veya bo≈üsa) bu ki≈üiyi atla veya bo≈ü bas (Tercih senin)
                // ≈ûimdilik hepsini basƒ±yoruz.

                let html = `
                <div class="print-page">
                    <div class="print-header">
                        <h2>NESƒ∞BE AYDIN OKULLARI</h2>
                        <h4>4. Sƒ±nƒ±flar Genel Deƒüerlendirme Raporu</h4>
                    </div>
                    <p><strong>√ñƒürenci:</strong> ${name} <span style="float:right"><strong>Tarih:</strong> ${today}</span></p>
                    
                    <h4 style="background:#eee; padding:5px;">T√úRK√áE</h4>
                    <table class="print-table">
                        <tr><th style="text-align:left">Konu</th><th width="40">Tam</th><th width="40">Kƒ±s</th><th width="40">Yok</th></tr>
                        ${turkishQ.map(q => {
                            const s = data.scores[q.id];
                            return `<tr>
                                <td>${q.code} - ${q.text}</td>
                                <td class="print-check">${s===2 ? 'X' : ''}</td>
                                <td class="print-check">${s===1 ? 'X' : ''}</td>
                                <td class="print-check">${s===0 ? 'X' : ''}</td>
                            </tr>`;
                        }).join('')}
                    </table>

                    <h4 style="background:#eee; padding:5px;">MATEMATƒ∞K</h4>
                    <table class="print-table">
                        <tr><th style="text-align:left">Konu</th><th width="40">Tam</th><th width="40">Kƒ±s</th><th width="40">Yok</th></tr>
                        ${mathQ.map(q => {
                            const s = data.scores[q.id];
                            return `<tr>
                                <td>${q.code} - ${q.text}</td>
                                <td class="print-check">${s===2 ? 'X' : ''}</td>
                                <td class="print-check">${s===1 ? 'X' : ''}</td>
                                <td class="print-check">${s===0 ? 'X' : ''}</td>
                            </tr>`;
                        }).join('')}
                    </table>

                    ${data.comment ? `<div style="margin-top:20px; border:1px solid #333; padding:10px;"><strong>√ñƒüretmen G√∂r√º≈ü√º:</strong><br>${data.comment}</div>` : ''}
                    
                    <div style="margin-top:40px; text-align:right;">Sƒ±nƒ±f √ñƒüretmeni<br>ƒ∞mza</div>
                </div>
                `;
                printDiv.innerHTML += html;
            });

            window.print();
        }
    </script>
</body>
</html>
