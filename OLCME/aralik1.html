<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4. Sƒ±nƒ±f Geli≈üim ve Takip Sistemi</title>
    <style>
        :root {
            --primary: #2c3e50; /* Koyu Lacivert */
            --accent: #3498db;  /* Mavi */
            --success: #27ae60; /* Ye≈üil */
            --warning: #f1c40f; /* Sarƒ± */
            --danger: #e74c3c;  /* Kƒ±rmƒ±zƒ± */
            --bg: #ecf0f1;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg);
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* --- √úST PANEL (√ñƒürenci Listesi) --- */
        #top-bar {
            background: white;
            padding: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            z-index: 10;
        }

        h2 { margin: 0 0 10px 0; font-size: 1.2rem; color: var(--primary); text-align: center; }

        .student-scroll {
            display: flex;
            gap: 10px;
            overflow-x: auto;
            padding-bottom: 5px;
            -webkit-overflow-scrolling: touch; /* Mobilde akƒ±cƒ± kaydƒ±rma */
        }

        .student-chip {
            flex: 0 0 auto;
            padding: 10px 20px;
            background: #eee;
            border-radius: 50px;
            font-size: 0.9rem;
            color: #555;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
            font-weight: 600;
        }

        .student-chip.active {
            background: var(--accent);
            color: white;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.4);
            transform: scale(1.05);
        }

        .student-chip.done {
            background: #d5f5e3;
            color: var(--success);
            border-color: var(--success);
        }
        
        .student-chip.done.active {
            background: var(--success);
            color: white;
        }

        /* --- ORTA ALAN (Sorular) --- */
        #workspace {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
            box-sizing: border-box;
        }

        .rubric-item {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .rubric-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: bold;
            color: var(--primary);
        }
        
        .category-tag {
            font-size: 0.7rem;
            background: #eee;
            padding: 3px 8px;
            border-radius: 4px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-group {
            display: flex;
            gap: 8px;
        }

        .btn-score {
            flex: 1;
            padding: 12px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.2s;
        }

        /* Se√ßim Durumlarƒ± */
        .btn-score[data-val="2"].selected { background: var(--success); color: white; border-color: var(--success); }
        .btn-score[data-val="1"].selected { background: var(--warning); color: #333; border-color: var(--warning); }
        .btn-score[data-val="0"].selected { background: var(--danger); color: white; border-color: var(--danger); }

        /* --- ALT PANEL (Mesaj ve ƒ∞≈ülemler) --- */
        #bottom-panel {
            background: white;
            border-top: 1px solid #ddd;
            padding: 15px;
            display: none; /* √ñƒürenci se√ßilince g√∂r√ºn√ºr */
        }

        #message-box {
            width: 100%;
            height: 100px;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 10px;
            font-family: inherit;
            font-size: 0.9rem;
            resize: none;
            margin-bottom: 10px;
            background: #f9f9f9;
        }

        .action-btns {
            display: flex;
            gap: 10px;
        }

        .btn-action {
            flex: 1;
            padding: 12px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            color: white;
            font-size: 1rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .btn-copy { background: var(--primary); }
        .btn-print { background: var(--accent); }
        .btn-reset { background: #95a5a6; flex: 0.3; }

        /* --- YAZDIRMA AYARLARI --- */
        @media print {
            #top-bar, .btn-group, .action-btns, .btn-reset { display: none !important; }
            body { overflow: visible; height: auto; background: white; }
            #workspace { overflow: visible; padding: 0; }
            .rubric-item { box-shadow: none; border: 1px solid #eee; break-inside: avoid; }
            
            /* Se√ßili puanƒ± yazdƒ±rƒ±rken g√∂ster */
            .btn-score { display: none; }
            .btn-score.selected { 
                display: block; 
                width: 100%; 
                border: none; 
                text-align: left; 
                padding: 0;
                color: black !important;
                background: none !important;
            }
            .btn-score.selected::before { content: "‚úÖ Puan: "; }

            #message-box { border: none; height: auto; font-style: italic; }
            #bottom-panel { display: block !important; border: none; }
        }
    </style>
</head>
<body>

    <div id="top-bar">
        <h2>4. Sƒ±nƒ±f Deƒüerlendirme & Takip</h2>
        <div class="student-scroll" id="student-list">
            </div>
    </div>

    <div id="workspace">
        <div id="welcome-msg" style="text-align: center; color: #777; margin-top: 50px;">
            <h3>üëÜ Listeden bir √∂ƒürenci se√ßerek ba≈ülayƒ±n</h3>
        </div>
        <div id="rubric-container" style="display: none;">
            </div>
    </div>

    <div id="bottom-panel">
        <div style="font-weight: bold; margin-bottom: 5px; color: var(--primary);">Veli Bilgilendirme Notu:</div>
        <textarea id="message-box"></textarea>
        <div class="action-btns">
            <button class="btn-action btn-copy" onclick="copyMessage()">üìã Kopyala</button>
            <button class="btn-action btn-print" onclick="window.print()">üñ®Ô∏è PDF Al</button>
            <button class="btn-action btn-reset" onclick="resetStudent()">Sil</button>
        </div>
    </div>

<script>
    // --- 1. VERƒ∞LER ---
    
    const students = [
        "HAKAN AKDENƒ∞Z", "H√úSEYƒ∞N √áAƒûAN G√úRGAH", "AHMET ARIN AƒûT√úRK", "DENƒ∞Z G√úNEY", 
        "ƒ∞Dƒ∞L DEMƒ∞RCƒ∞", "DURU AYKANAT", "DENƒ∞Z Kƒ∞MYON", "KADƒ∞R BERKTA≈û", 
        "DOƒûA BORA", "AHMET CEVDET KORKMAZ", "G√úLNƒ∞HAL KARAKA≈û", "Nƒ∞L Tƒ∞RYAKƒ∞", 
        "MASAL DEFNE TEL", "EYL√úL AFAT", "ELƒ∞F ADA KEKE√á", "EYL√úL MUTAF", 
        "ƒ∞PEK Mƒ∞MAROƒûLU", "YEKTA URAS DEMƒ∞RER", "HAMZA KAAN √áEVEN", "BEYZA DAƒûDELEN", 
        "NAZ KARABAƒûLI", "AYNUR BUDAK", "DURU B√úK√úN", "WAFA MAKANSSI"
    ];

    // PDF'e G√∂re Hazƒ±rlanmƒ±≈ü Kazanƒ±mlar
    const rubric = [
        {
            id: 't1', cat: 'T√úRK√áE', 
            text: 'Milli M√ºcadele ≈üiirini yorumlama (Atat√ºrk\'√ºn rotasƒ±, halkƒ±n tepkisi).',
            msg_good: '≈ûiiri yorumlama ve ana duyguyu kavramada √ßok ba≈üarƒ±lƒ±.',
            msg_bad: '≈ûiirdeki ana duyguyu ve olay √∂rg√ºs√ºn√º bulmakta zorlanƒ±yor.'
        },
        {
            id: 't2', cat: 'T√úRK√áE', 
            text: 'Metindeki neden-sonu√ß, soru ve kar≈üƒ±la≈ütƒ±rma c√ºmlelerini bulma.',
            msg_good: 'Okuduƒüu metindeki anlam ili≈ükilerini (neden-sonu√ß vb.) hatasƒ±z buluyor.',
            msg_bad: 'Neden-sonu√ß ve kar≈üƒ±la≈ütƒ±rma c√ºmlelerini ayƒ±rt etme √ßalƒ±≈ümalarƒ± yapmalƒ±.'
        },
        {
            id: 't3', cat: 'T√úRK√áE', 
            text: 'E≈ü sesli ve zƒ±t anlamlƒ± kelimeleri doƒüru kullanma.',
            msg_good: 'Kelime bilgisi (e≈ü sesli/zƒ±t anlam) olduk√ßa kuvvetli.',
            msg_bad: 'E≈ü sesli kelimelerin farklƒ± anlamlarƒ±nƒ± c√ºmle i√ßinde kullanmada desteƒüe ihtiyacƒ± var.'
        },
        {
            id: 'm1', cat: 'MATEMATƒ∞K', 
            text: 'Doƒüal sayƒ±larƒ± en yakƒ±n onluƒüa ve y√ºzl√ºƒüe yuvarlama.',
            msg_good: 'Sayƒ±larƒ± yuvarlama ve tahmin etme becerisi gayet iyi.',
            msg_bad: 'Sayƒ±larƒ± en yakƒ±n onluƒüa/y√ºzl√ºƒüe yuvarlarken kural hatalarƒ± yapƒ±yor.'
        },
        {
            id: 'm2', cat: 'MATEMATƒ∞K', 
            text: '√áok adƒ±mlƒ± toplama ve √ßƒ±karma problemlerini √ß√∂zme.',
            msg_good: 'Matematik problemlerini analiz edip i≈ülem adƒ±mlarƒ±nƒ± doƒüru uyguluyor.',
            msg_bad: 'Problemleri √ß√∂zerken i≈ülem adƒ±mlarƒ±nƒ± karƒ±≈ütƒ±rabiliyor, bol pratik gerekli.'
        },
        {
            id: 'm3', cat: 'MATEMATƒ∞K', 
            text: 'Sayƒ± √∂r√ºnt√ºlerini (artan/azalan/dallanmƒ±≈ü) kuralƒ±na g√∂re devam ettirme.',
            msg_good: 'Sayƒ± √∂r√ºnt√ºlerindeki kuralƒ± hƒ±zlƒ±ca fark edip devam ettirebiliyor.',
            msg_bad: 'Karma≈üƒ±k sayƒ± √∂r√ºnt√ºlerinin kuralƒ±nƒ± bulmakta zorlanƒ±yor.'
        }
    ];

    // --- 2. UYGULAMA MANTIƒûI ---

    let currentStudent = null;
    let db = JSON.parse(localStorage.getItem('student_db_v1')) || {};

    const studentListEl = document.getElementById('student-list');
    const rubricContainer = document.getElementById('rubric-container');
    const bottomPanel = document.getElementById('bottom-panel');
    const messageBox = document.getElementById('message-box');

    // Ba≈ülangƒ±√ß: Listeyi Olu≈ütur
    function init() {
        renderStudentList();
    }

    function renderStudentList() {
        studentListEl.innerHTML = '';
        students.forEach(name => {
            const div = document.createElement('div');
            div.className = `student-chip ${db[name] ? 'done' : ''}`;
            if (currentStudent === name) div.classList.add('active');
            div.innerText = name;
            div.onclick = () => selectStudent(name);
            studentListEl.appendChild(div);
        });
    }

    function selectStudent(name) {
        currentStudent = name;
        document.getElementById('welcome-msg').style.display = 'none';
        rubricContainer.style.display = 'block';
        bottomPanel.style.display = 'block';
        
        renderStudentList(); // Aktif sƒ±nƒ±fƒ± g√ºncelle
        renderRubric();
        generateMessage(); // Varsa eski mesajƒ± getir
    }

    function renderRubric() {
        rubricContainer.innerHTML = '';
        const data = db[currentStudent] || {};

        rubric.forEach(item => {
            const div = document.createElement('div');
            div.className = 'rubric-item';
            
            // Se√ßili buton hangisi?
            const val = data[item.id];

            div.innerHTML = `
                <div class="rubric-header">
                    <span>${item.text}</span>
                    <span class="category-tag">${item.cat}</span>
                </div>
                <div class="btn-group">
                    <button class="btn-score ${val===2 ? 'selected':''}" data-val="2" onclick="saveScore('${item.id}', 2)">Tam</button>
                    <button class="btn-score ${val===1 ? 'selected':''}" data-val="1" onclick="saveScore('${item.id}', 1)">Kƒ±smen</button>
                    <button class="btn-score ${val===0 ? 'selected':''}" data-val="0" onclick="saveScore('${item.id}', 0)">Geli≈ümeli</button>
                </div>
            `;
            rubricContainer.appendChild(div);
        });
    }

    window.saveScore = function(qId, val) {
        if (!db[currentStudent]) db[currentStudent] = {};
        db[currentStudent][qId] = val;
        
        // Kaydet
        localStorage.setItem('student_db_v1', JSON.stringify(db));
        
        // Aray√ºz√º G√ºncelle (Renklenmesi i√ßin)
        renderRubric();
        renderStudentList(); // Tepedeki √ßip ye≈üil olsun
        
        // Mesajƒ± anlƒ±k olu≈ütur
        generateMessage();
    }

    // --- 3. AKILLI MESAJ Sƒ∞STEMƒ∞ ---
    function generateMessage() {
        const data = db[currentStudent];
        if (!data) {
            messageBox.value = "";
            return;
        }

        let goodPoints = [];
        let badPoints = [];
        let total = 0;
        let count = 0;

        rubric.forEach(item => {
            const val = data[item.id];
            if (val !== undefined) {
                total += val;
                count++;
                if (val === 2) goodPoints.push(item.msg_good);
                if (val === 0 || val === 1) badPoints.push(item.msg_bad); // Kƒ±smen de geli≈ümeli sayƒ±labilir
            }
        });

        if (count === 0) return;

        // Mesaj ≈ûablonu
        let msg = `Sayƒ±n Velimiz,\n\n${currentStudent} ile yaptƒ±ƒüƒ±mƒ±z 8 Aralƒ±k deƒüerlendirme √ßalƒ±≈ümasƒ±nƒ±n sonu√ßlarƒ± ≈ü√∂yledir:\n\n`;

        // Olumlu C√ºmleler
        if (goodPoints.length > 0) {
            // Rastgele 1-2 tanesini se√ßip birle≈ütirelim ki √ßok uzun olmasƒ±n
            msg += `‚úÖ ${goodPoints.slice(0, 3).join(' ')}\n\n`; 
        }

        // Geli≈ütirilmesi Gerekenler
        if (badPoints.length > 0) {
            msg += `üîª ${badPoints.join(' ')}\n\n`;
            msg += `Evde yapacaƒüƒ±nƒ±z tekrarlarla bu eksikleri kƒ±sa s√ºrede tamamlayacaƒüƒ±na inanƒ±yorum.\n`;
        } else {
            msg += `üßø Genel performansƒ± harika, t√ºm kazanƒ±mlarƒ± ba≈üarƒ±yla edinmi≈ü g√∂r√ºn√ºyor. Tebrik ederim.\n`;
        }

        msg += `\nƒ∞yi g√ºnler dilerim.\nSƒ±nƒ±f √ñƒüretmeni`;
        
        messageBox.value = msg;
    }

    window.copyMessage = function() {
        const txt = document.getElementById('message-box');
        txt.select();
        txt.setSelectionRange(0, 99999);
        navigator.clipboard.writeText(txt.value).then(() => {
            alert("Kopyalandƒ±! WhatsApp'a yapƒ±≈ütƒ±rabilirsiniz.");
        });
    }
    
    window.resetStudent = function() {
        if(confirm('Notlarƒ± silmek istiyor musunuz?')) {
            delete db[currentStudent];
            localStorage.setItem('student_db_v1', JSON.stringify(db));
            selectStudent(currentStudent);
        }
    }

    init();

</script>
</body>
</html>
