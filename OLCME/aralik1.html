<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>4. SÄ±nÄ±f AralÄ±k DeÄŸerlendirme Takibi</title>
<style>
    :root { --blue: #2c3e50; --green: #27ae60; --orange: #f39c12; --red: #c0392b; --bg: #ecf0f1; }
    body { font-family: 'Segoe UI', sans-serif; background: var(--bg); margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
    
    /* Ãœst Panel: Ã–ÄŸrenci Listesi */
    #top-bar { background: white; padding: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); z-index: 10; }
    .scroll-view { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 5px; -webkit-overflow-scrolling: touch; }
    .student-btn { 
        flex: 0 0 auto; padding: 10px 15px; background: #eee; border-radius: 20px; 
        font-size: 13px; font-weight: 600; cursor: pointer; border: 2px solid transparent; 
    }
    .student-btn.active { background: var(--blue); color: white; transform: scale(1.05); }
    .student-btn.done { border-color: var(--green); background: #e8f8f5; color: var(--green); }
    .student-btn.done.active { background: var(--green); color: white; }

    /* Orta Panel: Sorular */
    #workspace { flex: 1; overflow-y: auto; padding: 15px; }
    .card { background: white; border-radius: 10px; padding: 15px; margin-bottom: 15px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
    .card h4 { margin: 0 0 10px 0; color: var(--blue); font-size: 15px; }
    .card small { color: #7f8c8d; font-weight: bold; display: block; margin-bottom: 5px; }
    
    .btn-group { display: flex; gap: 5px; }
    .score-btn { 
        flex: 1; padding: 12px; border: 1px solid #ddd; border-radius: 5px; background: white; 
        font-weight: bold; cursor: pointer; font-size: 14px;
    }
    .score-btn[data-v="2"].sel { background: var(--green); color: white; border-color: var(--green); }
    .score-btn[data-v="1"].sel { background: var(--orange); color: white; border-color: var(--orange); }
    .score-btn[data-v="0"].sel { background: var(--red); color: white; border-color: var(--red); }

    /* Alt Panel: Mesaj */
    #bottom-panel { background: white; padding: 15px; border-top: 1px solid #ccc; }
    textarea { width: 100%; height: 80px; padding: 8px; border: 1px solid #ddd; border-radius: 5px; resize: none; font-family: inherit; margin-bottom: 10px; box-sizing: border-box;}
    .actions { display: flex; gap: 10px; }
    .act-btn { flex: 1; padding: 12px; border: none; border-radius: 5px; color: white; font-weight: bold; cursor: pointer; font-size: 14px; }
    .btn-copy { background: var(--blue); }
    .btn-pdf { background: #8e44ad; }
    .btn-del { background: #95a5a6; flex: 0.3; }

    /* YAZDIRMA (A4 Ã‡Ä±ktÄ±sÄ±) */
    @media print {
        #top-bar, #bottom-panel, .btn-group { display: none !important; }
        body { overflow: visible; height: auto; background: white; }
        #workspace { padding: 0; overflow: visible; }
        .card { box-shadow: none; border-bottom: 1px solid #eee; break-inside: avoid; page-break-inside: avoid; margin: 0; padding: 10px 0; }
        .card h4 { font-size: 14px; margin-bottom: 2px; }
        
        /* SeÃ§ili puanÄ± metin olarak gÃ¶ster */
        .score-display { display: block !important; font-weight: bold; font-size: 12px; margin-top: 2px;}
        .score-display.s2::after { content: "âœ… TAM (2 Puan)"; color: black; }
        .score-display.s1::after { content: "âš ï¸ KISMEN (1 Puan)"; color: black; }
        .score-display.s0::after { content: "âŒ GELÄ°ÅMELÄ° (0 Puan)"; color: black; }

        /* BaÅŸlÄ±k ekle */
        #workspace::before {
            content: "4. SINIF GELÄ°ÅÄ°M RAPORU - " attr(data-student);
            display: block; font-size: 20px; font-weight: bold; text-align: center; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid black;
        }
        /* Ã–ÄŸretmen notunu ekle */
        #workspace::after {
            content: "Ã–ÄRETMEN DEÄERLENDÄ°RMESÄ°: \A" attr(data-msg);
            white-space: pre-wrap; display: block; margin-top: 30px; padding: 15px; border: 1px dashed #ccc; font-size: 12px;
        }
    }
    .score-display { display: none; }
</style>
</head>
<body>

<div id="top-bar">
    <div style="text-align:center; font-weight:bold; margin-bottom:5px; color:#2c3e50;">4. SÄ±nÄ±f AralÄ±k DeÄŸerlendirme</div>
    <div class="scroll-view" id="studentList"></div>
</div>

<div id="workspace" data-student="" data-msg="">
    <div id="intro" style="text-align:center; margin-top:50px; color:#777;">
        <h3>Listeden bir Ã¶ÄŸrenci seÃ§iniz</h3>
    </div>
    <div id="questions" style="display:none;"></div>
</div>

<div id="bottom-panel" style="display:none;">
    <textarea id="msgBox"></textarea>
    <div class="actions">
        <button class="act-btn btn-copy" onclick="copyMsg()">ğŸ“‹ Kopyala</button>
        <button class="act-btn btn-pdf" onclick="window.print()">ğŸ–¨ï¸ PDF</button>
        <button class="act-btn btn-del" onclick="resetStudent()">ğŸ—‘ï¸</button>
    </div>
</div>

<script>
// 1. Ã–ÄRENCÄ° LÄ°STESÄ° (VerdiÄŸin Liste)
const students = [
    "HAKAN AKDENÄ°Z", "HÃœSEYÄ°N Ã‡AÄAN GÃœRGAH", "AHMET ARIN AÄTÃœRK", "DENÄ°Z GÃœNEY", "Ä°DÄ°L DEMÄ°RCÄ°", 
    "DURU AYKANAT", "DENÄ°Z KÄ°MYON", "KADÄ°R BERKTAÅ", "DOÄA BORA", "AHMET CEVDET KORKMAZ", 
    "GÃœLNÄ°HAL KARAKAÅ", "NÄ°L TÄ°RYAKÄ°", "MASAL DEFNE TEL", "EYLÃœL AFAT", "ELÄ°F ADA KEKEÃ‡", 
    "EYLÃœL MUTAF", "Ä°PEK MÄ°MAROÄLU", "YEKTA URAS DEMÄ°RER", "HAMZA KAAN Ã‡EVEN", "BEYZA DAÄDELEN", 
    "NAZ KARABAÄLI", "AYNUR BUDAK", "DURU BÃœKÃœN", "WAFA MAKANSSI"
];

// 2. SORULAR (PDF Ä°Ã§eriÄŸinden)
const rubric = [
    { cat:"TÃœRKÃ‡E", text:"Milli MÃ¼cadele ÅŸiirini yorumlar (AtatÃ¼rk'Ã¼n kararÄ±, Samsun'a Ã§Ä±kÄ±ÅŸ).", good:"Milli MÃ¼cadele ÅŸiirini ve duygusunu harika yorumluyor.", bad:"Åiirdeki ana duyguyu ve olay Ã¶rgÃ¼sÃ¼nÃ¼ kavramada desteÄŸe ihtiyacÄ± var." },
    { cat:"TÃœRKÃ‡E", text:"OkuduÄŸu metindeki neden-sonuÃ§ ve karÅŸÄ±laÅŸtÄ±rma cÃ¼mlelerini bulur.", good:"Metindeki neden-sonuÃ§ iliÅŸkilerini hatasÄ±z buluyor.", bad:"Neden-sonuÃ§ ve karÅŸÄ±laÅŸtÄ±rma cÃ¼mlelerini ayÄ±rt etme Ã§alÄ±ÅŸmalarÄ± yapmalÄ±." },
    { cat:"TÃœRKÃ‡E", text:"EÅŸ sesli ve zÄ±t anlamlÄ± kelimeleri ayÄ±rt eder.", good:"EÅŸ sesli ve zÄ±t anlamlÄ± kelimeler konusunda kelime hazinesi Ã§ok iyi.", bad:"EÅŸ sesli kelimelerin farklÄ± anlamlarÄ±nÄ± karÄ±ÅŸtÄ±rabiliyor." },
    { cat:"MATEMATÄ°K", text:"DoÄŸal sayÄ±larÄ± en yakÄ±n onluÄŸa ve yÃ¼zlÃ¼ÄŸe yuvarlar.", good:"SayÄ±larÄ± yuvarlama ve tahmin etme becerisi gayet iyi.", bad:"SayÄ±larÄ± yuvarlarken bazen kural hatasÄ± yapÄ±yor." },
    { cat:"MATEMATÄ°K", text:"SayÄ± Ã¶rÃ¼ntÃ¼lerini kuralÄ±na gÃ¶re devam ettirir (Ã–rn: A < 3479).", good:"SÄ±ralama ve Ã¶rÃ¼ntÃ¼ mantÄ±ÄŸÄ±nÄ± Ã§ok iyi kavramÄ±ÅŸ.", bad:"SayÄ± Ã¶rÃ¼ntÃ¼lerindeki artÄ±ÅŸ/azalÄ±ÅŸ kuralÄ±nÄ± bulmakta zorlanÄ±yor." },
    { cat:"MATEMATÄ°K", text:"Ã‡ok adÄ±mlÄ± problemleri Ã§Ã¶zer (Quizizz puan tablosu).", good:"Verilen problemleri analiz edip iÅŸlem adÄ±mlarÄ±nÄ± doÄŸru uyguluyor.", bad:"Problemleri Ã§Ã¶zerken iÅŸlem adÄ±mlarÄ±nÄ± karÄ±ÅŸtÄ±rabiliyor." },
    { cat:"MATEMATÄ°K", text:"DallanmÄ±ÅŸ aÄŸaÃ§ diyagramÄ±ndaki kuralÄ± uygular (Ãœst+200, Alt-100).", good:"KarmaÅŸÄ±k gÃ¶rsel Ã¶rÃ¼ntÃ¼leri (aÄŸaÃ§ diyagramÄ± gibi) baÅŸarÄ±yla Ã§Ã¶zÃ¼yor.", bad:"GÃ¶rsel tablolardaki (aÄŸaÃ§ diyagramÄ±) kurallarÄ± takip etmekte zorlandÄ±." },
    { cat:"MATEMATÄ°K", text:"Ã‡Ä±karma iÅŸlemi gerektiren problemleri Ã§Ã¶zer (DÃ¼rbÃ¼n/Mesafe).", good:"Ã‡Ä±karma iÅŸlemi gerektiren problemleri hatasÄ±z yapÄ±yor.", bad:"Problemlerde iÅŸlem hatasÄ± yapabiliyor, dikkat etmeli." }
];

// 3. SÄ°STEM
let current = null;
let db = JSON.parse(localStorage.getItem('sinif_db_2025')) || {};

function init() {
    const list = document.getElementById('studentList');
    list.innerHTML = '';
    students.forEach(name => {
        const btn = document.createElement('div');
        btn.className = `student-btn ${db[name] ? 'done' : ''}`;
        btn.innerText = name;
        btn.onclick = () => loadStudent(name);
        list.appendChild(btn);
    });
}

function loadStudent(name) {
    current = name;
    document.getElementById('intro').style.display = 'none';
    document.getElementById('questions').style.display = 'block';
    document.getElementById('bottom-panel').style.display = 'block';
    
    // Aktif butonu gÃ¼ncelle
    document.querySelectorAll('.student-btn').forEach(b => {
        b.classList.remove('active');
        if(b.innerText === name) b.classList.add('active');
    });

    renderQuestions();
    makeMsg();
    
    // PDF iÃ§in veri etiketleri
    const ws = document.getElementById('workspace');
    ws.setAttribute('data-student', name);
}

function renderQuestions() {
    const box = document.getElementById('questions');
    box.innerHTML = '';
    const data = db[current] || {};

    rubric.forEach((item, idx) => {
        const val = data[idx];
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
            <small>${item.cat}</small>
            <h4>${idx+1}. ${item.text}</h4>
            <div class="score-display s${val}"></div>
            <div class="btn-group">
                <button class="score-btn ${val===2?'sel':''}" data-v="2" onclick="save(${idx}, 2)">Tam</button>
                <button class="score-btn ${val===1?'sel':''}" data-v="1" onclick="save(${idx}, 1)">KÄ±smen</button>
                <button class="score-btn ${val===0?'sel':''}" data-v="0" onclick="save(${idx}, 0)">GeliÅŸmeli</button>
            </div>
        `;
        box.appendChild(card);
    });
}

function save(qIdx, score) {
    if(!db[current]) db[current] = {};
    db[current][qIdx] = score;
    localStorage.setItem('sinif_db_2025', JSON.stringify(db));
    
    renderQuestions(); // UI Yenile
    makeMsg(); // MesajÄ± Yenile
    
    // Listeyi gÃ¼ncelle (YeÅŸil tÄ±k iÃ§in)
    const listBtns = document.querySelectorAll('.student-btn');
    students.forEach((s, i) => {
        if(s === current) listBtns[i].classList.add('done');
    });
}

function makeMsg() {
    const data = db[current];
    if(!data) { document.getElementById('msgBox').value = ''; return; }

    let goods = [], bads = [];
    rubric.forEach((item, idx) => {
        if(data[idx] === 2) goods.push(item.good);
        if(data[idx] === 0 || data[idx] === 1) bads.push(item.bad);
    });

    let msg = `SayÄ±n Velimiz,\n${current} ile 8 AralÄ±k deÄŸerlendirmesi yaptÄ±k.\n`;
    
    if(goods.length > 0) msg += `âœ… ${goods.slice(0,2).join(' ')} \n`; 
    if(bads.length > 0) msg += `ğŸ”» ${bads.join(' ')} KonularÄ±nda tekrar yapmasÄ± faydalÄ± olacaktÄ±r.\n`;
    if(bads.length === 0 && goods.length > 0) msg += `ğŸ§¿ Ã–ÄŸrencimiz harika bir performans gÃ¶sterdi, tebrik ederim.\n`;

    msg += `Ä°yi gÃ¼nler dilerim.\nSÄ±nÄ±f Ã–ÄŸretmeni`;
    
    const txt = document.getElementById('msgBox');
    txt.value = msg;
    document.getElementById('workspace').setAttribute('data-msg', msg);
}

function copyMsg() {
    const t = document.getElementById('msgBox');
    t.select(); t.setSelectionRange(0,99999);
    navigator.clipboard.writeText(t.value);
    alert('Mesaj kopyalandÄ±!');
}

function resetStudent() {
    if(confirm('NotlarÄ± silmek istiyor musunuz?')) {
        delete db[current];
        localStorage.setItem('sinif_db_2025', JSON.stringify(db));
        loadStudent(current);
        init(); // Listeyi gÃ¼ncelle
        document.querySelector('.student-btn.active').classList.remove('done');
    }
}

init();
</script>
</body>
</html>
