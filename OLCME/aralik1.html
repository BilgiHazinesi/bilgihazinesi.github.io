<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GeliÅŸmiÅŸ DeÄŸerlendirme ve TasarÄ±m AracÄ±</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --accent-color: #3498db;
            --bg-color: #f4f6f9;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            display: flex;
            height: 100vh;
            background-color: var(--bg-color);
            overflow: hidden;
        }

        /* --- SOL ARAÃ‡ Ã‡UBUÄžU (Toolbar) --- */
        #toolbar {
            width: 60px;
            background-color: var(--primary-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-top: 20px;
            gap: 15px;
            z-index: 100;
        }

        .tool-btn {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 18px;
            position: relative;
        }
        
        .tool-btn:hover { background: var(--accent-color); }
        .tool-btn::after { /* Tooltip */
            content: attr(title);
            position: absolute;
            left: 50px;
            background: #333;
            color: #fff;
            padding: 5px;
            font-size: 12px;
            border-radius: 3px;
            opacity: 0;
            pointer-events: none;
            white-space: nowrap;
        }
        .tool-btn:hover::after { opacity: 1; }

        /* --- ORTA ALAN (KaÄŸÄ±t/Sayfa) --- */
        #workspace {
            flex: 1;
            background-color: #bdc3c7;
            display: flex;
            justify-content: center;
            overflow: auto;
            padding: 40px;
            position: relative;
        }

        .page {
            width: 210mm;
            min-height: 297mm; /* A4 */
            background: white;
            box-shadow: 0 0 15px rgba(0,0,0,0.2);
            position: relative;
            padding: 20mm;
            box-sizing: border-box;
            transition: transform 0.3s;
        }

        /* Elemanlar iÃ§in basit stil (GÃ¶rsel/Metin kutusu temsili) */
        .draggable-item {
            position: absolute;
            border: 1px dashed #ccc;
            cursor: move;
            min-width: 50px;
            min-height: 20px;
        }
        
        .draggable-item:hover { border-color: var(--accent-color); }

        /* --- SAÄž PANEL (Liste GÃ¶rÃ¼nÃ¼mÃ¼) --- */
        #right-panel {
            width: 280px;
            background: white;
            border-left: 1px solid #ddd;
            display: flex;
            flex-direction: column;
            padding: 10px;
            overflow-y: auto;
        }
        
        #right-panel h3 { font-size: 16px; margin-bottom: 10px; border-bottom: 2px solid var(--accent-color); padding-bottom: 5px;}

        /* GÃ¶rseller - Liste GÃ¶rÃ¼nÃ¼mÃ¼ (Grid DEÄžÄ°L) */
        .asset-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .asset-item {
            display: flex;
            align-items: center;
            padding: 8px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
        
        .asset-item img {
            width: 40px;
            height: 40px;
            object-fit: cover;
            margin-right: 10px;
            border-radius: 4px;
        }
        
        .asset-info { font-size: 13px; }

        /* --- RUBRÄ°K (DEÄžERLENDÄ°RME) BÃ–LÃœMÃœ --- */
        #rubric-section {
            margin-top: 20px;
            border-top: 2px solid #333;
            padding-top: 10px;
        }

        .rubric-controls {
            display: flex;
            gap: 5px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .rubric-btn {
            font-size: 11px;
            padding: 5px 8px;
            background: #ecf0f1;
            border: 1px solid #bdc3c7;
            cursor: pointer;
            border-radius: 3px;
        }
        .rubric-btn:hover { background: #d5dbdb; }

        /* Rubrik Tablosu - TAM HÄ°ZALAMA Ä°Ã‡Ä°N */
        .rubric-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
        }

        .rubric-table th, .rubric-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: center;
            vertical-align: middle;
        }

        .rubric-table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }

        .rubric-table td:nth-child(2) { /* Ã–lÃ§Ã¼t SÃ¼tunu */
            text-align: left;
            width: 50%;
        }

        .score-radio {
            transform: scale(1.2);
            cursor: pointer;
        }

        /* --- JSON YEDEKLEME ALANI --- */
        #backup-controls {
            margin-top: auto; /* En alta it */
            padding-top: 15px;
            border-top: 1px solid #eee;
        }
        
        .action-btn {
            width: 100%;
            padding: 8px;
            margin-bottom: 5px;
            background: var(--accent-color);
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .action-btn.secondary { background: #95a5a6; }

    </style>
</head>
<body>

    <div id="toolbar">
        <button class="tool-btn" title="Metin Ekle">T</button>
        <button class="tool-btn" title="GÃ¶rsel Ekle">IMG</button>
        <button class="tool-btn" title="SayfayÄ± Ã‡evir (Yatay/Dikey)" onclick="rotatePage()">âŸ³</button>
        <button class="tool-btn" title="Yeni Sayfa Ekle">+</button>
    </div>

    <div id="workspace">
        <div id="active-page" class="page">
            <h3>4. SÄ±nÄ±f Fen Bilimleri DeÄŸerlendirme</h3>
            <p>Ã–rnek iÃ§erik alanÄ±. Buraya sÃ¼rÃ¼klenen nesneler gelecek.</p>
        </div>
    </div>

    <div id="right-panel">
        
        <div id="backup-controls">
            <h3>Yedekleme</h3>
            <button class="action-btn" onclick="saveWork()">ðŸ’¾ Ã‡alÄ±ÅŸmayÄ± Yedekle (Ä°ndir)</button>
            <input type="file" id="loadInput" style="display: none;" onchange="loadWork(this)">
            <button class="action-btn secondary" onclick="document.getElementById('loadInput').click()">ðŸ“‚ Yedekten YÃ¼kle</button>
        </div>

        <div id="rubric-section">
            <h3>Puanlama AnahtarÄ± (Rubrik)</h3>
            
            <div class="rubric-controls">
                <button class="rubric-btn" onclick="bulkScore(2)">Hepsini Tam Yap</button>
                <button class="rubric-btn" onclick="bulkScore(1)">Hepsini KÄ±smen Yap</button>
                <button class="rubric-btn" onclick="bulkScore(0)">Hepsini YapmadÄ±</button>
                <button class="rubric-btn" onclick="clearRubric()" style="color:red;">Temizle</button>
            </div>

            <table class="rubric-table">
                <thead>
                    <tr>
                        <th style="width: 30px;">No</th>
                        <th>Ã–lÃ§Ã¼t / Soru</th>
                        <th>Tam (2p)</th>
                        <th>KÄ±smen (1p)</th>
                        <th>Yok (0p)</th>
                    </tr>
                </thead>
                <tbody id="rubric-body">
                    </tbody>
                <tfoot>
                    <tr>
                        <td colspan="2" style="text-align: right; font-weight: bold;">Toplam Puan:</td>
                        <td colspan="3" id="total-score" style="font-weight: bold; color: var(--accent-color);">0</td>
                    </tr>
                </tfoot>
            </table>
        </div>

        <div style="margin-top: 20px;">
            <h3>GÃ¶rsel KÃ¼tÃ¼phanesi</h3>
            <ul class="asset-list">
                <li class="asset-item">
                    <img src="https://via.placeholder.com/40" alt="Harita">
                    <div class="asset-info">
                        <strong>Harita.png</strong><br>
                        <span>GÃ¶rseli sÃ¼rÃ¼kle</span>
                    </div>
                </li>
                <li class="asset-item">
                    <img src="https://via.placeholder.com/40" alt="AtatÃ¼rk">
                    <div class="asset-info">
                        <strong>Ataturk.jpg</strong><br>
                        <span>GÃ¶rseli sÃ¼rÃ¼kle</span>
                    </div>
                </li>
            </ul>
        </div>

    </div>

    <script>
        // --- VERÄ° MODELÄ° ---
        // Sayfa durumu ve Rubrik verilerini burada tutacaÄŸÄ±z.
        let appState = {
            pageOrientation: 'portrait', // portrait veya landscape
            rubricData: [
                { id: 'q1', no: '1', text: 'MÄ±knatÄ±sÄ±n kutuplarÄ±nÄ± doÄŸru isimlendirir.', score: null, max: 2 },
                { id: 'q2', no: '2', text: 'Kuvvetin etkilerine Ã¶rnekler verir.', score: null, max: 2 },
                { id: 'q3a', no: '3-a', text: 'Fosil oluÅŸum sÄ±rasÄ±nÄ± yazar.', score: null, max: 2 },
                { id: 'q3b', no: '3-b', text: 'Fosillerin Ã¶nemini aÃ§Ä±klar.', score: null, max: 2 },
                { id: 'q4', no: '4', text: 'Besin iÃ§eriklerini sÄ±nÄ±flandÄ±rÄ±r.', score: null, max: 2 }
            ],
            canvasContent: [] // Sayfadaki nesnelerin koordinatlarÄ± vb. (ÅŸimdilik boÅŸ)
        };

        const rubricBody = document.getElementById('rubric-body');
        const totalScoreDisplay = document.getElementById('total-score');

        // --- RUBRÄ°K OLUÅžTURUCU (HizalÄ± Tablo YapÄ±sÄ±) ---
        function renderRubric() {
            rubricBody.innerHTML = '';
            let total = 0;

            appState.rubricData.forEach((item, index) => {
                const tr = document.createElement('tr');
                
                // Puan durumuna gÃ¶re 'checked' ekle
                const checked2 = item.score === 2 ? 'checked' : '';
                const checked1 = item.score === 1 ? 'checked' : '';
                const checked0 = item.score === 0 ? 'checked' : '';

                tr.innerHTML = `
                    <td><strong>${item.no}</strong></td>
                    <td>${item.text}</td>
                    <td><input type="radio" name="q_${item.id}" value="2" class="score-radio" onchange="updateScore('${item.id}', 2)" ${checked2}></td>
                    <td><input type="radio" name="q_${item.id}" value="1" class="score-radio" onchange="updateScore('${item.id}', 1)" ${checked1}></td>
                    <td><input type="radio" name="q_${item.id}" value="0" class="score-radio" onchange="updateScore('${item.id}', 0)" ${checked0}></td>
                `;
                rubricBody.appendChild(tr);

                if(item.score !== null) total += item.score;
            });

            totalScoreDisplay.innerText = total;
        }

        // --- PUAN GÃœNCELLEME ---
        function updateScore(id, val) {
            const item = appState.rubricData.find(x => x.id === id);
            if (item) {
                item.score = val;
                renderRubric(); // ToplamÄ± ve gÃ¶rÃ¼nÃ¼mÃ¼ yenile
            }
        }

        // --- TOPLU Ä°ÅžLEMLER ---
        function bulkScore(val) {
            appState.rubricData.forEach(item => {
                item.score = val;
            });
            renderRubric();
        }

        function clearRubric() {
            appState.rubricData.forEach(item => {
                item.score = null;
            });
            renderRubric();
        }

        // --- SAYFA YÃ–NÃœ (Ä°stediÄŸiniz Ã¶zellik) ---
        function rotatePage() {
            const page = document.getElementById('active-page');
            if (appState.pageOrientation === 'portrait') {
                page.style.width = '297mm';
                page.style.minHeight = '210mm';
                appState.pageOrientation = 'landscape';
            } else {
                page.style.width = '210mm';
                page.style.minHeight = '297mm';
                appState.pageOrientation = 'portrait';
            }
        }

        // --- JSON YEDEKLEME SÄ°STEMÄ° (Yeni Ä°stek) ---
        
        // 1. Ä°ndirme (Download)
        function saveWork() {
            // Åžu anki tarihi dosya adÄ±na ekleyelim
            const date = new Date().toISOString().slice(0,10);
            const fileName = `degerlendirme_yedek_${date}.json`;

            // Veriyi string'e Ã§evir
            const jsonStr = JSON.stringify(appState, null, 2);
            
            // Ä°ndirme linki oluÅŸtur
            const blob = new Blob([jsonStr], { type: "application/json" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = fileName;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // 2. YÃ¼kleme (Upload)
        function loadWork(input) {
            const file = input.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const loadedState = JSON.parse(e.target.result);
                    
                    // Mevcut durumu gÃ¼ncelle
                    appState = loadedState;
                    
                    // ArayÃ¼zÃ¼ yenile
                    renderRubric();
                    
                    // Sayfa yÃ¶nÃ¼nÃ¼ geri yÃ¼kle
                    const page = document.getElementById('active-page');
                    if (appState.pageOrientation === 'landscape') {
                         page.style.width = '297mm';
                         page.style.minHeight = '210mm';
                    } else {
                         page.style.width = '210mm';
                         page.style.minHeight = '297mm';
                    }

                    alert("Yedek baÅŸarÄ±yla yÃ¼klendi!");

                } catch (err) {
                    alert("Dosya bozuk veya hatalÄ± formatta.");
                    console.error(err);
                }
            };
            reader.readAsText(file);
            // Input'u sÄ±fÄ±rla ki aynÄ± dosyayÄ± tekrar seÃ§ebilelim
            input.value = '';
        }

        // BaÅŸlangÄ±Ã§ta rubriÄŸi Ã§iz
        renderRubric();

    </script>
</body>
</html>
